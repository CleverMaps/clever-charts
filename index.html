<!DOCTYPE html>
<meta charset="utf-8">

<head>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/4.8.0/d3.min.js"></script>
    <script src="dist/histogram-1.0.0.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"/>
</head>

<style>
    .zoom-btn {
        margin-left:730px;
    }
</style>

<body>
    <button class="zoom-btn">Zoom</button>
    <div class="graphs-ct"></div>
    <script>
        // docs: https://github.com/d3/d3-format
        // all locales: https://unpkg.com/d3-format@1.2.0/locale/
        // set cs-CZ locale by default
        d3.formatDefaultLocale({
            "decimal": ",",
            "thousands": " ",
            "grouping": [
                3
            ],
            "currency": [
                "",
                " Kč"
            ]
        });

        // histogram 1 (default selection) ================================================================
        var histogram = new Histogram({
            width:360,
            height:150
        });

        histogram.render(".graphs-ct");

        d3.json("data/sample.json", (json) => {
            histogram.setData(json.content);  
        });

        histogram.on("selectionOver", (selectionIndex)=>{
            console.log("histogram 1: selectionOver:"+selectionIndex);
        });

        histogram.on("toggleSelection", (selectionIndex, enabled)=>{
            console.log("histogram 1: toggleSelection:"+selectionIndex+", enabled:"+enabled);
        });

        histogram.on("selectionChanged", (selection)=>{
            console.log("histogram 1: selectionChanged:"+JSON.stringify(selection, null, 4));
        });

        // histogram 2 (filter) ==================================================================================
        var histogram2 = new Histogram({
            width:360,
            height:150,
            // filter specific settings, need to disable selection toggle and set different colors on hover and selection
            enableSelectionToggle:false,
            overSelectionColor:"#49ace2",
            selectionColor:"#49ace2"
            
        });

        histogram2.render(".graphs-ct");

        d3.json("data/sample.json", (json) => {
            histogram2.setData(json.content, [{
                from:100,
                to:300
            }]);
        });

        histogram2.on("selectionOver", (selectionIndex)=>{
            console.log("histogram 2: selectionOver:"+selectionIndex);
        });

        histogram2.on("toggleSelection", (selectionIndex, enabled)=>{
            console.log("histogram 2: toggleSelection:"+selectionIndex+", enabled:"+enabled);
        });        

        histogram2.on("selectionChanged", (selection)=>{
            console.log("histogram 2: selectionChanged:"+JSON.stringify(selection, null, 4));
        });        

        // simulate zoom
        d3.select(".zoom-btn").on("click", ()=>{
            d3.json("data/sample-zoomed.json", (json) => {
                histogram2.setData(json.content, [{
                    from:1,
                    to:420
                }]);
            });
        });

        // histogram 3 (inverted filter) ===================================================================================
        var histogram3 = new Histogram({
            width:360,
            enableSelectionToggle:false,
            height:150,
            overSelectionColor:"#49ace2",
            selectionColor:"#49ace2"            

        });

        histogram3.render(".graphs-ct");

        d3.json("data/sample.json", (json) => {
            histogram3.setData(json.content, [
                {
                    from:1,
                    to:200
                },
                {
                    from:200,
                    disabled:true,
                    to:300
                },
                {
                    from:300,
                    to:420
                }
            ]);
        });

        histogram3.on("selectionOver", (selectionIndex)=>{
            console.log("histogram 3: selectionOver:"+selectionIndex);
        });

        histogram3.on("toggleSelection", (selectionIndex, enabled)=>{
            console.log("histogram 3: toggleSelection:"+selectionIndex+", enabled:"+enabled);
        });        

        histogram3.on("selectionChanged", (selection)=>{
            console.log("histogram 3: selectionChanged:"+JSON.stringify(selection, null, 4));
        });          
    </script>
</body>