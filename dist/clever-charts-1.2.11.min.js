!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):t.CleverCharts=e(t.d3)}(this,function(_){"use strict";function t(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===i&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)};function h(t){this.value=t}function e(r){var a,o;function s(t,e){try{var i=r[t](e),n=i.value;n instanceof h?Promise.resolve(n.value).then(function(t){s("next",t)},function(t){s("throw",t)}):l(i.done?"return":"normal",i.value)}catch(t){l("throw",t)}}function l(t,e){switch(t){case"return":a.resolve({value:e,done:!0});break;case"throw":a.reject(e);break;default:a.resolve({value:e,done:!1})}(a=a.next)?s(a.key,a.arg):o=null}this._invoke=function(n,r){return new Promise(function(t,e){var i={key:n,arg:r,resolve:t,reject:e,next:null};o?o=o.next=i:(a=o=i,s(n,r))})},"function"!=typeof r.return&&(this.return=void 0)}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t};function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function B(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}var a=(i(s,[{key:"on",value:function(t,e){if(!(t in this._handlers))throw"No such event: "+t;return this._handlers[t].push(e),this}},{key:"off",value:function(t,e){if(!(t in this._handlers))throw"No such event: "+t;if(e){var i=this._handlers[t],n=i.indexOf(e);-1!=n&&i.splice(n,1)}else this._handlers[t]=[];return this}},{key:"add",value:function(t){return t in this._handlers||(this._handlers[t]=[]),this}},{key:"fire",value:function(t){if(!(t in this._handlers))throw"No such event: "+t;for(var e=this._handlers[t],i=arguments.length,n=Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];for(var a=0;a<e.length;a++)e[a].apply(this,n);return this}},{key:"destroy",value:function(){return this._handlers=null,this}}]),s);function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];P(this,s),this._handlers=t.reduce(function(t,e){return t[e]=[],t},{})}t("._svg_fm7vm_1 {\r\n    \r\n}\r\n\r\n._doughnut_fm7vm_9 {\r\n    \r\n}\r\n\r\n._arc_fm7vm_17 {\r\n    \r\n}",{});var c="_svg_fm7vm_1",d="_doughnut_fm7vm_9",f=2*Math.PI,l=(i(u,[{key:"isRendered",value:function(){return this._rendered}},{key:"render",value:function(t){var e=this,i=this._containerEl=_.select(t),n=this._containerEl.node().offsetWidth,r=this._containerEl.node().offsetHeight,a=this._value=this._options.value,o=this._angle=a/100*f,s=this._innerRadius=this._options.innerRadius,l=this._outerRadius=this._options.outerRadius,h=this._arc=_.arc().innerRadius(s).outerRadius(l).startAngle(0);this._svgEl=i.append("svg").attr("width",n).attr("height",r).attr("class",c);var u=this._groupEl=this._svgEl.append("g").attr("class",d).attr("transform","translate("+n/2+", "+r/2+")");return this._inactiveArc=u.append("path").datum({endAngle:f}).attr("fill",this._options.inactiveColor).attr("d",h),this._activeArc=u.append("path").datum({endAngle:o}).attr("fill",this._options.activeColor).attr("d",h),this._backgroundArc=u.append("circle").attr("fill",this._options.backgroundColor).attr("r",s).attr("cx",0).attr("cy",0),this._backgroundArc=u.append("circle").attr("fill",this._options.backgroundColor).attr("r",s).attr("cx",0).attr("cy",0),this._hoverEl=u.append("rect").attr("fill","transparent").attr("x",-n/2).attr("y",-r/2).attr("width",n).attr("height",r),u.on("mouseover",function(){e._observable.fire("mouseOver")}),u.on("mouseout",function(){e._observable.fire("mouseOut")}),this._rendered=!0,this}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"update",value:function(t){var e=this,i=t||{};void 0===i.value?i.value=this._value:this._value=i.value;var n=this._activeArc.transition().duration(this._options.animationDuration).attrTween("d",this._arcTween(i,!0));return this._inactiveArc.transition().duration(this._options.animationDuration).attrTween("d",function(){return function(){return e._arc({endAngle:f})}}),this._backgroundArc.transition().duration(this._options.animationDuration).attrTween("r",function(){return function(){return e._innerRadius}}),i.activeColor&&i.activeColor!==this._options.activeColor&&(this._options.activeColor=i.activeColor,n.attr("fill",i.activeColor)),this}},{key:"_arcTween",value:function(t){var n=this,r=t.value/100*f;void 0!==t.value&&(r=t.value/100*f);var e=this._innerRadius,i=this._outerRadius;void 0!==t.innerRadius&&(e=t.innerRadius),void 0!==t.outerRadius&&(i=t.outerRadius);var a=_.interpolate(this._outerRadius,i),o=_.interpolate(this._innerRadius,e);return function(e){var i=_.interpolate(e.endAngle,r);return function(t){return n._arc.outerRadius(n._outerRadius=a(t)),n._arc.innerRadius(n._innerRadius=o(t)),e.endAngle=n._angle=i(t),n._arc(e)}}}},{key:"destroy",value:function(){return this._rendered&&this._containerEl.node().removeChild(this._svgEl.node()),this._observable.destroy(),this}}]),u);function u(t){P(this,u),this._options=t,this._containerEl=null,this._groupEl=null,this._svgEl=null,this._rendered=!1,this._observable=new a(["mouseOver","mouseOut"])}function p(t,e){return void 0===t?e:t}var v=(i(g,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._doughnutRenderer.destroy(),this._options=null,this}},{key:"render",value:function(t){return this._doughnutRenderer.render(t),this}},{key:"update",value:function(t){if(!this._doughnutRenderer.isRendered())throw"Can't call update() when widget is not rendered, please call .render() first.";return this._doughnutRenderer.update(t),this}}]),g);function g(t){var e=this;P(this,g),this._options={},this._options.outerRadius=p(t.outerRadius,10),this._options.innerRadius=p(t.innerRadius,10),this._options.activeColor=p(t.activeColor,"#49ace2"),this._options.inactiveColor=p(t.inactiveColor,"#F0F0F0"),this._options.backgroundColor=p(t.backgroundColor,"transparent"),this._options.value=p(t.value,0),this._options.animationDuration=p(t.animationDuration,250),this._options.renderTo=p(t.renderTo,null),this._observable=new a(["mouseOver","mouseOut"]),this._doughnutRenderer=new l(this._options),this._doughnutRenderer.on("mouseOver",function(){e._observable.fire("mouseOver")}),this._doughnutRenderer.on("mouseOut",function(){e._observable.fire("mouseOut")}),t.renderTo&&this.render(t.renderTo)}var b={top:0,left:5,right:5,bottom:15},y=["#e6f3fb","#cbe7f6","#b1dbf2","#98cfee","#7ec4ea"],m=(i(k,[{key:"getMinMax",value:function(){return this._minMax}},{key:"getData",value:function(){return this._histogramData}},{key:"_calculateMinMax",value:function(t){return{min:_.min(t,function(t){return t.value}),max:_.max(t,function(t){return t.value})}}},{key:"getValueRatio",value:function(){return(this._minMax.max-this._minMax.min)/this._options.width}},{key:"positionToValue",value:function(t){var e=this.getMinMax();return 0===t?e.min:t===this._options.width?e.max:t*this.getValueRatio()+e.min}},{key:"valueToPosition",value:function(t){var e=this.getValueRatio(),i=this.getMinMax(),n=Math.min(Math.max(t,i.min),i.max);return Math.round(n/e-i.min/e)}},{key:"_loadHistogramData",value:function(r,t){var a=[],o=(t-1)/r.length;return r.forEach(function(t,e){var i=(t.max-t.min)/o,n=Array.isArray(t.volume)?t.volume:[t.volume];_.range(t.min,t.max,i).forEach(function(t){a.push({value:t,volume:n})}),e==r.length-1&&a.push({value:t.max,volume:n})}),a}}]),k);function k(t,e){P(this,k),this._histogramData=this._loadHistogramData(t,e.width),this._minMax=this._calculateMinMax(this._histogramData),this._options=e}t("._histogram_5umgo_1 text {\r\n    font-family: Roboto;\r\n}\r\n\r\n._bar_5umgo_9 {\r\n\r\n}\r\n\r\ng {\r\n    border:1px solid #eeeeee;\r\n}\r\n\r\ng ._selectionbar_5umgo_25 {\r\n    cursor:default;\r\n}\r\n\r\ng ._selectionbaricon_5umgo_33 {\r\n    cursor:default;\r\n}\r\n\r\ng ._selectionbargroup_5umgo_41 {\r\n    cursor:default;\r\n}\r\n\r\n._x-axis_5umgo_49>path {\r\n    stroke: #F1F1F1;\r\n}\r\n\r\n._x-axis_5umgo_49 {\r\n    border:0;\r\n}\r\n\r\ng > text {\r\n    user-select: none;\r\n}\r\n\r\n._x-axis_5umgo_49>._tick_5umgo_73>text {\r\n    fill:#7d7d7d;\r\n}\r\n\r\ng._active_5umgo_81 ._custom-handle-circle_5umgo_81 {\r\n    stroke:#4a4a4a;\r\n}\r\n\r\ng._inactive_5umgo_89:not(._dragging_5umgo_89) ._custom-handle-circle_5umgo_81 {\r\n    stroke:#bababa;\r\n    r:2.5;\r\n}\r\n\r\ng._inactive_5umgo_89._dragging_5umgo_89 ._custom-handle-circle_5umgo_81 {\r\n    stroke:#4a4a4a;\r\n}    \r\n\r\ng._brush-drag_5umgo_107 ._custom-handle-circle_5umgo_81 {\r\n    stroke:#4a4a4a;\r\n}    \r\n\r\n._custom-handle-circle_5umgo_81 {\r\n    transition: r 0.1s ease-out;\r\n    pointer-events: none;\r\n}\r\n\r\n._brush-axis-line_5umgo_125 {\r\n    stroke:#4a4a4a;\r\n    display: none;\r\n    stroke-width: 1px;\r\n}\r\n\r\n._custom-handle-line_5umgo_137 {\r\n    stroke-width:0;\r\n    fill:#4A4A4A;\r\n    pointer-events: none;\r\n}\r\n\r\n._handle_5umgo_149 {\r\n    transition: all 0.05s ease-out;\r\n}\r\n\r\n._brush_5umgo_107>._selection_5umgo_25 {\r\n    fill: rgba(0, 0, 0, 0);\r\n    stroke: transparent;\r\n    cursor: grab;\r\n    cursor: -webkit-grab;\r\n    cursor: -moz-grab;\r\n}\r\n\r\n._brush_5umgo_107>._overlay_5umgo_173._grabbing_5umgo_173,\r\n._brush_5umgo_107>._selection_5umgo_25._grabbing_5umgo_173 {\r\n    cursor: grabbing ;\r\n    cursor: -webkit-grabbing ;\r\n    cursor: -moz-grabbing ;\r\n}\r\n\r\n._custom-handle_5umgo_81 {\r\n\r\n}\r\n\r\n._drag-label_5umgo_195 {\r\n    fill:#4A4A4A;\r\n}",{});var x={histogram:"_histogram_5umgo_1",bar:"_bar_5umgo_9",selectionbar:"_selectionbar_5umgo_25",selectionbaricon:"_selectionbaricon_5umgo_33",selectionbargroup:"_selectionbargroup_5umgo_41","x-axis":"_x-axis_5umgo_49",tick:"_tick_5umgo_73",active:"_active_5umgo_81","custom-handle-circle":"_custom-handle-circle_5umgo_81",inactive:"_inactive_5umgo_89",dragging:"_dragging_5umgo_89","brush-drag":"_brush-drag_5umgo_107","brush-axis-line":"_brush-axis-line_5umgo_125","custom-handle-line":"_custom-handle-line_5umgo_137",handle:"_handle_5umgo_149",brush:"_brush_5umgo_107",selection:"_selection_5umgo_25",overlay:"_overlay_5umgo_173",grabbing:"_grabbing_5umgo_173","custom-handle":"_custom-handle_5umgo_81","drag-label":"_drag-label_5umgo_195"},w=0,S=(i(D,[{key:"destroy",value:function(){this._elements.forEach(function(t){return t.remove()}),this._elements=[]}},{key:"_renderHandle",value:function(){this._elements=[this._createHandleElement(),this._createHandleLineElement(),this._createHandleCircleElement(),this._createDragMaskElement(),this._createMaskGradientElement(),this._createDragLabelElement()],this._handleHoverState(),this._handleDrag()}},{key:"hide",value:function(){this._elements.forEach(function(t){return t.attr("visibility","hidden")})}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"getXPosition",value:function(){return parseInt(this._handleEl.attr("x"))+2}},{key:"setHoverState",value:function(){this._handleLineEl.attr("fill-opacity",1),this._handleLabelEl.attr("fill-opacity",1),this._handleMaskEl.attr("display","block"),this._handleCircleEl.attr("stroke-width",3),this._updateLabelPosition(this._position)}},{key:"getLabelBox",value:function(){return this._handleLabelEl.node().getBBox()}},{key:"setLabelOffset",value:function(t){this._handleLabelEl.attr("transform","translate("+t+", 0)"),this._handleMaskEl.attr("transform","translate("+t+", 0)"),this._updateLabelPosition(this._position)}},{key:"setHandleXPosition",value:function(t){return this._handleCircleEl.attr("transform","translate("+t+", "+this._options.height+")"),this}},{key:"setLabelText",value:function(t){return this._handleLabelEl.text(t),this}},{key:"showLabel",value:function(){return this._handleLabelEl.attr("fill-opacity",1),this._handleMaskEl.attr("display","block"),this}},{key:"hideLabel",value:function(){return this._handleLabelEl.attr("fill-opacity",0),this._handleMaskEl.attr("display","none"),this}},{key:"setLabelPosition",value:function(t){return this.setLabelOffset(0),this._updateLabelPosition(t),this}},{key:"unsetHoverState",value:function(){this._handleLineEl.attr("fill-opacity",0),this._handleLabelEl.attr("fill-opacity",0),this._handleMaskEl.attr("display","none"),this._handleCircleEl.attr("stroke-width",1),this._handleLabelEl.attr("transform","translate(0, 0)"),this._handleMaskEl.attr("transform","translate(0, 0)")}},{key:"enable",value:function(){this._elements.forEach(function(t){return t.attr("pointer-events","all")})}},{key:"disable",value:function(){this._elements.forEach(function(t){return t.attr("pointer-events","none")})}},{key:"_handleHoverState",value:function(){var t=this;this._handleEl.on("mouseover",function(){t._isOver=!0,t.setHoverState()}),this._handleEl.on("mouseout",function(){t._isOver=!1,t.unsetHoverState()})}},{key:"_onStartDrag",value:function(){this._groupEl.classed(x.dragging,!0),this._observable.fire("startDrag",this)}},{key:"_onDrag",value:function(){var t=this._options.width,e=this._options.height,i=Math.round(Math.max(Math.min(_.event.x,t),0));this._handleEl.attr("x",i-2),this._handleLineEl.attr("x",i-2),this._handleCircleEl.attr("transform","translate("+i+","+e+")"),this._handleEl.attr("data-handle-value",this._histogramData.positionToValue(i)),this.setHoverState(),this._position=i,parseInt(this._position)!==parseInt(this._initialPosition)?this._value=this._histogramData.positionToValue(i):this._value=this._initialValue,this._handleLabelEl.text(this._getLabelText()),this._updateLabelPosition(i),this._observable.fire("drag")}},{key:"_getLabelText",value:function(){return this._options.format(this._value)}},{key:"_onEndDrag",value:function(){this._groupEl.classed(x.dragging,!1),this._isOver||this.unsetHoverState(),this._observable.fire("endDrag",this)}},{key:"_handleDrag",value:function(){this._handleEl.call(_.drag().on("drag",this._onDrag.bind(this)).on("start",this._onStartDrag.bind(this)).on("end",this._onEndDrag.bind(this)))}},{key:"_getComputedLabelTextLength",value:function(t){var e=t.innerHTML;return this._labelSizeCache[e]=this._labelSizeCache[e]||t.getComputedTextLength(),this._labelSizeCache[e]}},{key:"_updateLabelPosition",value:function(t){var e=this._handleLabelEl.node(),i=this._options.fontSize,n=this._getComputedLabelTextLength(e),r=n+2*i,a=t-n/2;a<0&&(a=0),a+n>this._options.width?(a=this._options.width-n,this._handleLabelEl.attr("x",this._options.width),this._handleLabelEl.attr("text-anchor","end")):(this._handleLabelEl.attr("x",a),this._handleLabelEl.attr("text-anchor","start")),this._handleMaskEl.attr("x",function(){return parseInt(a)-i}),this._handleMaskGradientEl.attr("x1",a-i),this._handleMaskGradientEl.attr("x2",a+r-i),this._handleMaskEl.attr("width",r),this._handleMaskEl.attr("height",this._options.fontSize)}},{key:"_createMaskGradientElement",value:function(){return this._handleMaskGradientEl=this._groupEl.append("linearGradient").attr("id","brush-mask-gradient-"+w++).attr("gradientUnits","userSpaceOnUse").attr("y1",0).attr("x1",50).attr("y2",0).attr("x2",0),this._handleMaskGradientEl.selectAll("stop").data([{offset:"0%",color:"rgba(255,255,255,0)"},{offset:"20%",color:"rgba(255,255,255,1)"},{offset:"80%",color:"rgba(255,255,255,1)"},{offset:"100%",color:"rgba(255,255,255,0)"}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),this._handleMaskGradientEl}},{key:"_createHandleElement",value:function(){return this._handleEl=this._groupEl.append("rect").attr("class",x["custom-handle"]).attr("fill-opacity",0).attr("data-handle-index",this._index).attr("data-handle-value",this._value).attr("cursor","ew-resize").attr("width",4).attr("height",this._options.height+5).attr("x",this._position-2),this._handleEl}},{key:"_createHandleLineElement",value:function(){return this._handleLineEl=this._groupEl.append("rect").attr("class",x["custom-handle-line"]).attr("width",4).attr("height",this._options.height).attr("fill-opacity",0).attr("x",this._position-2),this._handleLineEl}},{key:"_createHandleCircleElement",value:function(){return this._handleCircleEl=this._groupEl.append("circle").attr("class",x["custom-handle-circle"]).attr("transform","translate("+this._position+","+this._options.height+")").attr("fill","#ffffff").attr("fill-opacity",1).attr("stroke","#000").attr("stroke-width",1).attr("cursor","ew-resize").attr("r",3.5),this._handleCircleEl}},{key:"_createDragMaskElement",value:function(){return this._handleMaskEl=this._groupEl.append("rect").attr("class",x["drag-label-mask"]).attr("fill","url(#brush-mask-gradient-"+w+")").attr("y",this._options.height+7).attr("display","none"),this._handleMaskEl}},{key:"_createDragLabelElement",value:function(){var t=this,e=this._options.format,i=this._options.height;return this._handleLabelEl=this._groupEl.append("text").attr("class",x["drag-label"]).attr("fill-opacity",0).attr("font-size",this._options.fontSize).text(function(){return e(t._initialValue)}).attr("y",i+this._options.fontSize+7),this._updateLabelPosition(this._position),this._handleLabelEl}}]),D);function D(t,e,i,n,r){P(this,D),this._observable=new a(["drag","startDrag","endDrag"]),this._handleEl=null,this._handleLineEl=null,this._handleCircleEl=null,this._handleMaskEl=null,this._handleMaskGradientEl=null,this._handleLabelEl=null,this._isOver=!1,this._groupEl=t,this._index=i,this._value=e,this._initialValue=new Number(e),this._position=n.valueToPosition(e),this._initialPosition=new Number(this._position),this._options=r,this._histogramData=n,this._labelSizeCache={},this._elements=[],this._renderHandle()}function T(t,e,i,n){var r=t.getLabelBox(),a=e.getLabelBox(),o=a.x-(r.x+r.width)-i;if(o<0){var s=o/2,l=o/2;r.x+s<0&&(s=r.x,l*=2);var h=a.x+a.width-l;return n<h&&(l+=h-n,s*=2),[s,-l]}return[0,0]}var E=(i(C,[{key:"isRendered",value:function(){return this._rendered}},{key:"render",value:function(t){return this._rendered=!0,this._groupEl=t,this}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"_clear",value:function(){this._destroyHandles(),this._selectionBarGroups&&this._selectionBarGroups.remove()}},{key:"_destroyHandles",value:function(){this._handles.forEach(function(t){return t.destroy()}),this._handles=[]}},{key:"_onHandleClick",value:function(a,t){var o=this;this._options.promptHandler&&this._options.promptHandler(t).then(function(t){var e=JSON.stringify(o._histogramSelection.getOutputSelection());t=parseFloat(t);var i=o._histogramData.getMinMax();t=Math.min(i.max,t),t=Math.max(i.min,t);var n=o._histogramSelection.getSelectionPoints();n[a]={value:t};var r=n.sort(function(t,e){return t.value-e.value}).map(function(t){return o._histogramData.valueToPosition(t.value)});o._updateSelectionPositions(r,n),o._updateSelection(),o._destroyHandles(),o._renderHandles(),JSON.stringify(o._options.selection)!=e&&o._observable.fire("selectionChanged",o._histogramSelection.getOutputSelection())}),this._observable.fire("handleClick",a,t)}},{key:"_toggleSelection",value:function(t){var e=this._options.selection[t];e.disabled=!e.disabled;var i=!e.disabled;this._updateSelection(),this._observable.fire("toggleSelection",t,i)}},{key:"_onClick",value:function(){var t=_.select(_.event.target),e=t.attr("data-selection-index"),i=t.attr("data-handle-index");null!=e&&this._histogramSelection.allowsToggle()?this._toggleSelection(e):null!=i&&this._onHandleClick(i,t.attr("data-handle-value"))}},{key:"_handleClick",value:function(){this._groupEl.on("click",this._onClick.bind(this))}},{key:"refresh",value:function(t,e,i){return this._animate=i&&i.animate,this._animate&&this._histogramSelection&&this._histogramSelection.getSelection().length==e.getSelection().length&&(this._prevSelection=this._histogramSelection.getSelection(),this._prevHistogramData=this._histogramSelection.getSelection()),this._animate&&this._histogramData&&(this._prevHistogramData=this._histogramData),this._histogramData=t,this._histogramSelection=e,this._clear(),this._renderSelection(),this._updateSelection(),this._handleHoverState(),this._handleClick(),this}},{key:"setSelection",value:function(t,e){return this.needRefresh(this._histogramSelection,t)?this.refresh(this._histogramData,t,e):(this._histogramSelection=t,this._updateSelection(),this)}},{key:"needRefresh",value:function(t,e){if(!t||!e)return!0;var n=t.getSelection(),i=e.getSelection();return!n||!i||n.length!==i.length||i.reduce(function(t,e,i){return e.from!==n[i].from||e.to!==n[i].to||t},!1)}},{key:"_updateSelectionControlsHoverState",value:function(t){var e=this._handles.slice().sort(function(t,e){return t.getXPosition()-e.getXPosition()});if(e.forEach(function(t){return t.unsetHoverState()}),null!=t){var i=e[t],n=e[t+1];i.setHoverState(),n.setHoverState();var r=T(i,n,this._options.fontSize,this._options.width);i.setLabelOffset(r[0]),n.setLabelOffset(r[1])}}},{key:"_onSelectionMouseOver",value:function(t,e,i){if(!this._draggingHandle){_.select(i[e]).attr("fill","rgba(0,0,0,0.00)");var n=parseInt(_.select(_.event.target).attr("data-selection-index"));this._overSelectionIndex!=n&&(this._overSelectionIndex=n,this._updateSelection(),this._updateSelectionControlsHoverState(n),this._observable.fire("selectionOver",this._overSelectionIndex))}}},{key:"_onSelectionMouseOut",value:function(t,e,i){this._draggingHandle||(_.select(i[e]).attr("fill","rgba(0,0,0,0)"),this._overSelectionIndex=null,this._updateSelectionControlsHoverState(null),this._updateSelection(),this._observable.fire("selectionOver",this._overSelectionIndex))}},{key:"_handleHoverState",value:function(){var t=this._groupEl;t.selectAll("."+x.selectionbargroup).on("mouseout",this._onSelectionMouseOut.bind(this)),t.selectAll("."+x.selectionbargroup).on("mouseover",this._onSelectionMouseOver.bind(this))}},{key:"_onHandleDrag",value:function(){var t=this._handles.map(function(t){return t.getXPosition()}).sort(function(t,e){return t-e});this._updateSelectionPositions(t),this._updateSelection()}},{key:"_updateSelectionPositions",value:function(r,a){var o=this,s=this._histogramSelection.getSelection();r.forEach(function(t,e){if(!(e>s.length-1)){var i={from:t,to:r[e+1]},n={from:a?a[e].value:o._histogramData.positionToValue(i.from),to:a?a[e+1].value:o._histogramData.positionToValue(i.to)};["from","to"].forEach(function(t){(a?s[e][t]!==n[t]:s[e].position[t]!==i[t])&&(s[e][t]=n[t],s[e].position[t]=i[t])})}})}},{key:"_renderSelection",value:function(){var t=this._options.height,e=this._histogramSelection.getSelection();this._selectionBarGroups=this._groupEl.selectAll("."+x.selectionbargroup).data([].concat(o(e)).reverse()).enter().append("g").attr("class",x.selectionbargroup).attr("y",0).attr("height",t),this._selectionBarsIcons=this._selectionBarGroups.append("image").attr("class",x.selectionbaricon).attr("xlink:href",function(t){return t.icon?t.icon.src:null}),this._selectionBars=this._selectionBarGroups.append("rect").attr("class",x.selectionbar).attr("y",0).attr("fill","rgba(0,0,0,0.00)").attr("height",t),this._renderHandles()}},{key:"_renderHandles",value:function(){var a=this;this._handles=this._histogramSelection.getSelectionPoints().map(function(t,e){var i,n=t.value,r=new S(a._groupEl,n,e,a._histogramData,a._options);return t.hidden&&r.hide(),r.on("drag",function(){a._onHandleDrag()},a),r.on("startDrag",function(){i=JSON.stringify(a._options.selection),a._draggingHandle=!0,a._handles.forEach(function(t){return t.disable()}),r.enable()},a),r.on("endDrag",function(){a._draggingHandle=!1,a._handles.forEach(function(t){return t.enable()}),JSON.stringify(a._options.selection)!=i&&a._observable.fire("selectionChanged",a._histogramSelection.getOutputSelection())},a),r})}},{key:"_getBarSelectionIndex",value:function(t,e,i){for(var n=0;n<e.length;n++){var r=e[n],a=n==e.length-1;if(t>=i.valueToPosition(r.from)&&(t<i.valueToPosition(r.to)||a&&t<=i.valueToPosition(r.to)))return n}return null}},{key:"_getSelectionColor",value:function(t,e){return t.colors?t.colors[e.volumeIndex]:t.color?t.color:this._options.selectionColor}},{key:"_getBarColor",value:function(e,t,i,n){var r=this._options.inactiveBarColor,a=this._options.overSelectionColor,o=this._options.segmentDivider,s=this._getBarSelectionIndex(e,t,i);return null==s?r:o&&t.some(function(t){return(e===t.position.to||e===t.position.from)&&!t.disabled})?o:t[s].disabled?r:this._histogramSelection.allowsToggle()&&this._overSelectionIndex==s?a:this._getSelectionColor(t[s],n)}},{key:"_getBarOpacity",value:function(t,e,i){var n=this._getBarSelectionIndex(t,e,i),r=this._histogramSelection.allowsToggle()&&this._overSelectionIndex==n,a=null!=n&&e[n].disabled;return r?this._options.overSelectionOpacity:a?this._options.inactiveBarOpacity:null!=n&&null!=e[n].opacity?e[n].opacity:1}},{key:"_onSelectionTransition",value:function(o,s,l,h,u,c){var _=this;o.forEach(function(t,n){var e=s[n],i=_._options.width;if(o[n]){var r,a=[];a.push([Math.round(l.valueToPosition(t.from)),Math.round(h.valueToPosition(e.from))]),a.push([Math.round(l.valueToPosition(t.to)),Math.round(h.valueToPosition(e.to))]),r=[Math.abs((a[0][0]-a[0][1])/i),Math.abs((a[1][0]-a[1][1])/i)],a.forEach(function(t,e){for(var i=0;t[0]!==t[1];)setTimeout(u.bind(_,t[0],n,e),i),i+=.5/r[e],t[0]=t[0]>t[1]?t[0]-1:t[0]+1;0<i&&setTimeout(function(t,e,i){u(t,e,i),c(t,e,i)}.bind(_,t[1],n,e),++i)})}})}},{key:"_updateSelection",value:function(){function t(i,n){a.attr("fill",function(t){var e=r._histogramData.valueToPosition(t.value);return r._getBarColor(e,i,n,t)}),a.attr("fill-opacity",function(t){var e=r._histogramData.valueToPosition(t.value);return r._getBarOpacity(e,i,n,t)})}var r=this,n=this._histogramSelection.getSelection(),a=this._groupEl.selectAll("."+x.bar);if(this._animate&&this._prevSelection){var e=this._prevSelection,i=this._prevHistogramData;t(e,this._prevHistogramData),e.forEach(function(t,e){var i=r._prevHistogramData.valueToPosition(t.from),n=r._prevHistogramData.valueToPosition(t.to);r._handles[e].setHandleXPosition(i).setLabelPosition(i),r._handles[e+1].setHandleXPosition(n).setLabelPosition(n)}),this._animating=!0,this._onSelectionTransition(e,n,i,this._histogramData,function(e,t,i){_.select(a.nodes()[e]).attr("fill",function(t){return r._getBarColor(e,n,r._histogramData,t)}),[r._handles[t],r._handles[t+1]][i].setHandleXPosition(e).setLabelPosition(e)},function(){t(n,r._histogramData),r._animating=!1}),this._prevSelection=null,this._prevHistogramData=null}else t(n,this._histogramData);this._selectionBarGroups.data([].concat(o(n)).reverse()).attr("transform",function(t){return"translate("+r._histogramData.valueToPosition(t.from)+", 0)"}).attr("width",function(t){return r._histogramData.valueToPosition(t.to)-r._histogramData.valueToPosition(t.from)}),this._selectionBarsIcons.data([].concat(o(n)).reverse()).attr("data-selection-index",function(t,e){return n.length-e-1}).attr("visibility",function(t){return t.disabled?"hidden":"visible"}).attr("x",function(t){return(r._histogramData.valueToPosition(t.to)-r._histogramData.valueToPosition(t.from))/2}).attr("y",function(t){return t.icon&&"bottom"===t.icon.align?3*r._options.height/4:r._options.height/2}).attr("transform",function(t){if(!t.icon)return null;var e="bottom"===t.icon.align?-t.icon.height:-t.icon.height/2;return"translate("+-r.selectionIconWidth(t)/2+","+e+")"}).attr("width",this.selectionIconWidth.bind(this)).attr("height",function(t){return t.icon?t.icon.height:null}),this._selectionBars.data([].concat(o(n)).reverse()).attr("data-selection-index",function(t,e){return n.length-e-1}).attr("fill","rgba(0,0,0,0.00)").attr("width",function(t){return r._histogramData.valueToPosition(t.to)-r._histogramData.valueToPosition(t.from)})}},{key:"selectionIconWidth",value:function(t){return t.icon?"stretch"===t.icon.width?this._histogramData.valueToPosition(t.to)-this._histogramData.valueToPosition(t.from):t.icon.width:null}},{key:"showSelectionLabels",value:function(){var a=this;if(this._animating)return this._handles.forEach(function(t){return t.showLabel()});this._histogramSelection.getSelection().forEach(function(t,e){var i=a._handles[e],n=a._handles[e+1],r=T(i,n,a._options.fontSize,a._options.width);i.setLabelOffset(r[0]),n.setLabelOffset(r[1])}),this._handles.forEach(function(t){return t.showLabel()})}},{key:"hideSelectionLabels",value:function(){this._handles.forEach(function(t){return t.hideLabel()})}},{key:"destroy",value:function(){return this._observable.destroy(),this._clear(),this}}]),C);function C(t){P(this,C),this._options=t,this._groupEl=null,this._histogramData=null,this._histogramSelection=null,this._overSelectionIndex=null,this._rendered=!1,this._handles=[],this._draggingHandle=!1,this._prevSelection=null,this._rendered=!1,this._animating=!1,this._observable=new a(["selectionOver","toggleSelection","selectionChanged","handleClick"])}var M=(i(L,[{key:"isRendered",value:function(){return this._rendered}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"render",value:function(t){var e=this._containerEl=_.select(t),i=this._options.width,n=this._options.height,r=b,a=this._svgEl=e.append("svg").attr("width",i+r.left+r.right).attr("height",n+r.top+this._options.fontSize+r.bottom).classed(x.histogram,!0),o=this._groupEl=this._svgEl.append("g").classed(x.inactive,!0).attr("transform","translate("+r.left+","+r.top+")");return a.on("mouseover.hover",function(){o.classed(x.active,!0),o.classed(x.inactive,!1)}),a.on("mouseout.hover",function(){o.classed(x.inactive,!0),o.classed(x.active,!1)}),this._selectionRenderer.render(o),this._rendered=!0,this}},{key:"_clear",value:function(){this._groupEl.node().innerHTML=""}},{key:"refresh",value:function(t,e,i){return this._animate=i&&i.animate,this._histogramData=t,this._clear(),this._xAxis.domain(t.getData().map(function(t){return t.value})),this._yAxis.domain([0,_.max(t.getData(),function(t){return Math.max.apply(Math,t.volume)})]),this._renderXAxis(),this._renderDataBars(),this._prevData=t.getData(),this._selectionRenderer.refresh(t,e,i),this._labelsVisible&&this.showSelectionLabels(),this}},{key:"setSelection",value:function(t,e){this._selectionRenderer.setSelection(t,e)}},{key:"showSelectionLabels",value:function(){this._selectionRenderer.showSelectionLabels(),this._groupEl.selectAll("."+x["x-axis"]).attr("display","none"),this._labelsVisible=!0}},{key:"hideSelectionLabels",value:function(){this._selectionRenderer.hideSelectionLabels(),this._groupEl.selectAll("."+x["x-axis"]).attr("display","block"),this._labelsVisible=!1}},{key:"_renderDataBars",value:function(){var n=this,t=this._histogramData.getData(),r=this._options.height,a=this._yAxis;t.forEach(function(i){i.volume.forEach(function(t,e){n._groupEl.append("rect").datum({value:i.value,volumeIndex:e}).attr("class",x.bar).attr("x",n._histogramData.valueToPosition(i.value)).attr("width","1").attr("y",Math.floor(a(i.volume[e]))).attr("height",Math.ceil(r-a(i.volume[e])))})})}},{key:"_renderXAxis",value:function(){var i=this,t=this._histogramData.getMinMax(),e=this._options.format,n=this._options.height+this._options.fontSize+7;this._groupEl.selectAll("."+x["x-axis"]).data([t.min,t.max]).enter().append("text").text(function(t){return e(t)}).attr("font-size",this._options.fontSize).attr("transform",function(t,e){return["translate(0,"+n+")","translate("+i._options.width+","+n+")"][e]}).attr("text-anchor",function(t,e){return["start","end"][e]}).classed(x["x-axis"],!0)}},{key:"destroy",value:function(){return this._rendered&&this._containerEl.node().removeChild(this._svgEl.node()),this._observable.destroy(),this._selectionRenderer.destroy(),this}}]),L);function L(t){var i=this;P(this,L),this._options=t,this._containerEl=null,this._groupEl=null,this._svgEl=null,this._historyData=null,this._xAxis=_.scaleBand().range([0,t.width]),this._yAxis=_.scaleLinear().range([t.height,0]),this._rendered=!1,this._prevData=null,this._selectionRenderer=new E(t),this._labelsVisible=!1,this._observable=new a(["selectionOver","toggleSelection","selectionChanged","handleClick"]),this._selectionRenderer.on("selectionOver",function(t){i._observable.fire("selectionOver",t)}),this._selectionRenderer.on("toggleSelection",function(t,e){i._observable.fire("toggleSelection",t,e)}),this._selectionRenderer.on("selectionChanged",function(t){i._observable.fire("selectionChanged",t)}),this._selectionRenderer.on("handleClick",function(t,e){i._observable.fire("handleClick",t,e)})}var O=(i(A,[{key:"getSelection",value:function(){return this._selection}},{key:"getOutputSelection",value:function(){throw"HistogramSelection.getOutputSelection() has to be implemented"}},{key:"getSelectionType",value:function(){throw"HistogramSelection.getSelectionType() has to be implemented"}},{key:"allowsToggle",value:function(){throw"HistogramSelection.allowsToggle() has to be implemented"}},{key:"getSelectionPoints",value:function(){throw"HistogramSelection.getSelection() has to be implemented"}},{key:"getSelectionWithPositions",value:function(e,t){return t.map(function(t){return Object.assign(t,{position:{from:e.valueToPosition(t.from),to:e.valueToPosition(t.to)}})})}}]),A);function A(t,e){P(this,A),this._selection=this.getSelectionWithPositions(t,e)}var R={MULTI:"multi",FILTER:"filter",INVERTED_FILTER:"inverted-filter"},H=(r(z,O),i(z,[{key:"getSelectionType",value:function(){return R.MULTI}},{key:"getOutputSelection",value:function(){return this._selection}},{key:"allowsToggle",value:function(){return!0}},{key:"getSelectionPoints",value:function(){var i=[],n=this.getSelection();return n.forEach(function(t,e){i.push({value:t.from}),e==n.length-1&&i.push({value:t.to})}),i}}]),z);function z(t,e){return P(this,z),B(this,(z.__proto__||Object.getPrototypeOf(z)).call(this,t,e))}var F=(r(V,H),V);function V(t){P(this,V);var e=t.getMinMax(),i=y,n=e.min,r=(e.max-e.min)/i.length,a=i.map(function(t){var e=n,i=n+r;return n+=r,{from:e,to:i,color:t}});return B(this,(V.__proto__||Object.getPrototypeOf(V)).call(this,t,a))}var j=(r(I,O),i(I,[{key:"getOutputSelection",value:function(){return this._selection}},{key:"getSelectionType",value:function(){return R.FILTER}},{key:"allowsToggle",value:function(){return!1}},{key:"getSelectionPoints",value:function(){var i=[],n=this.getSelection();return n.forEach(function(t,e){i.push({value:t.from}),e==n.length-1&&i.push({value:t.to})}),i}}]),I);function I(t,e){if(P(this,I),1!=e.length)throw"Filter selection doesn't allow more than one selection";return B(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,t,e))}var N=(r(G,j),i(G,[{key:"_getInvertedSelection",value:function(t,e){var i=t.getMinMax(),n=[{from:i.min,to:e[0].from},{from:e[0].from,disabled:!0,to:e[0].to},{from:e[0].to,to:i.max}];return this.getSelectionWithPositions(t,n)}},{key:"getOutputSelection",value:function(){return[{from:this._selection[1].from,to:this._selection[1].to}]}},{key:"getSelectionType",value:function(){return R.INVERTED_FILTER}},{key:"getSelectionPoints",value:function(){var t=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}(G.prototype.__proto__||Object.getPrototypeOf(G.prototype),"getSelectionPoints",this).call(this);return t[0].hidden=!0,t[t.length-1].hidden=!0,t}}]),G);function G(t,e){P(this,G);var i=B(this,(G.__proto__||Object.getPrototypeOf(G)).call(this,t,e));return i._selection=i._getInvertedSelection(t,e),i}var W=(i(X,[{key:"getHistogramSelection",value:function(t,e){return t?this._options.selectionType==R.FILTER?new j(e,t):this._options.selectionType==R.INVERTED_FILTER?new N(e,t):new H(e,t):new F(e,this._options.selection)}}]),X);function X(t){P(this,X),this._options=t}function Z(t,e){return void 0===t?e:t}var U=(i(J,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._histogramRenderer.destroy(),this._options=null,this}},{key:"render",value:function(t){return this._histogramRenderer.render(t),this}},{key:"setData",value:function(t,e,i){if(!this._histogramRenderer.isRendered())throw"Can't call setData() when widget is not rendered, please call .render() first.";var n=this._histogramData=new m(t,this._options),r=this._histogramSelection=this._selectionFactory.getHistogramSelection(e,n);return this._options.selection=r.getSelection(),this._selection=e,this._options.format?"string"==typeof this._options.format&&(this._options.format=_.format(this._options.format)):this._options.format=function(t){return String(t)},this._histogramRenderer.refresh(n,r,i),this}},{key:"setSelectionType",value:function(t){return this._options.selectionType=t,this.setSelection(this._selection),this}},{key:"showSelectionLabels",value:function(){this._histogramRenderer.showSelectionLabels()}},{key:"hideSelectionLabels",value:function(){this._histogramRenderer.hideSelectionLabels()}},{key:"updateSelection",value:function(t,e){return this.setSelection(t,e)}},{key:"setSelection",value:function(t,e){if(!this._histogramRenderer.isRendered())throw"Can't call setData() when widget is not rendered, please call .render() first.";if(!this._histogramData)throw"Can't call setSelection() when no data is available.";var i=JSON.parse(JSON.stringify(t)),n=this._histogramSelection=this._selectionFactory.getHistogramSelection(i,this._histogramData);return this._options.selection=n.getSelection(),this._selection=i,this._histogramRenderer.setSelection(this._histogramSelection,e),this}}]),J);function J(t){var i=this;P(this,J),this._options={},this._options.promptHandler=t.promptHandler||null,this._options.width=Z(t.width,360),this._options.height=Z(t.height,150),this._options.format=Z(t.format,null),this._options.inactiveBarColor=Z(t.inactiveBarColor,"#f0f0f0"),this._options.inactiveBarOpacity=Z(t.inactiveBarOpacity,1),this._options.overSelectionColor=Z(t.overSelectionColor,"#ffea00"),this._options.overSelectionOpacity=Z(t.overSelectionOpacity,1),this._options.selectionColor=Z(t.selectionColor,"#49ace2"),this._options.enableSelectionToggle=Z(t.enableSelectionToggle,!0),this._options.fontSize=Z(t.fontSize,11),this._options.selectionType=Z(t.selectionType,null),this._options.segmentDivider=Z(t.segmentDivider,null),this._observable=new a(["selectionOver","toggleSelection","selectionChanged","handleClick"]),this._histogramRenderer=new M(this._options),this._histogramRenderer.on("selectionOver",function(t){i._observable.fire("selectionOver",t)}),this._histogramRenderer.on("toggleSelection",function(t,e){i._observable.fire("toggleSelection",t,e,_.event)}),this._histogramRenderer.on("selectionChanged",function(t){i._observable.fire("selectionChanged",t)}),this._histogramRenderer.on("handleClick",function(t,e){i._observable.fire("handleClick",t,e)}),this._selectionFactory=new W(this._options)}U.SelectionTypes=R;var q=[],Y=[],K=28,Q=(i($,[{key:"getMinMax",value:function(){return this._minMax}},{key:"getSeries",value:function(){return this._series}},{key:"getAllData",value:function(){return[].concat.apply([],this._series)}},{key:"getMergedData",value:function(){var i={};return this.getAllData().forEach(function(t){var e=i[t.label]||{label:t.label,values:[],tooltips:[]};e.values.push(t.value),e.tooltips.push(t.tooltip),i[t.label]=e}),Object.values(i)}},{key:"_calculateMinMax",value:function(t){var e=[].concat.apply([],t),i=_.min(e,function(t){return t.value}),n=_.max(e,function(t){return t.value});return e.length<=t.length&&(i=Math.min(i,0),n=Math.max(n,0)),{min:i,max:n}}},{key:"getPrecision",value:function(){var t=this._minMax.max.toString().split(".");return 1<t.length?t[1].length:0}}]),$);function $(t){P(this,$),this._series=t.slice(),this._minMax=this._calculateMinMax(this._series)}t("._line_rlucf_1 text {\r\n    font-size: 11px;\r\n    fill:#7d7d7d;\r\n    font-family: Roboto;\r\n}\r\n\r\n._line_rlucf_1 {\r\n    \r\n}\r\n\r\n._area_rlucf_21 {\r\n    \r\n}\r\n\r\n._tooltip-group_rlucf_29 {\r\n    \r\n}\r\n\r\n._tooltip-hover-area_rlucf_37 {\r\n    \r\n}\r\n\r\n._tooltip-line-circle_rlucf_45 {\r\n    fill: white;\r\n}\r\n\r\n._tooltip-axis-circle_rlucf_53 {\r\n    stroke:#bababa;\r\n    fill: white;\r\n}\r\n\r\n._tooltip-label-mask_rlucf_63 {\r\n    \r\n}\r\n\r\n._tooltip-top-label_rlucf_71 {\r\n    border-radius: 4px;\r\n    font-size: 11px;\r\n    fill:#7d7d7d;\r\n    pointer-events: none;\r\n    white-space: nowrap;\r\n    font-family: Roboto;    \r\n    background-color: #ffffff;\r\n    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2);\r\n    padding:3px 10px;\r\n    line-height:17px;\r\n}\r\n\r\n._svg_rlucf_97 {\r\n    overflow: visible;\r\n}",{});var tt={line:"_line_rlucf_1",area:"_area_rlucf_21","tooltip-group":"_tooltip-group_rlucf_29","tooltip-hover-area":"_tooltip-hover-area_rlucf_37","tooltip-line-circle":"_tooltip-line-circle_rlucf_45","tooltip-axis-circle":"_tooltip-axis-circle_rlucf_53","tooltip-label-mask":"_tooltip-label-mask_rlucf_63","tooltip-top-label":"_tooltip-top-label_rlucf_71",svg:"_svg_rlucf_97"},et=0,it=(i(nt,[{key:"isRendered",value:function(){return this._rendered}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"render",value:function(t){return this._groupEl=t,this._rendered=!0,this._groupEl.on("mouseout",this._onMouseOut.bind(this)),this}},{key:"_getTextAnchor",value:function(t,e,i){return t-e/2<0?"start":i<t+e/2?"end":"middle"}},{key:"_getTooltipHTML",value:function(r){var a=this;return r.tooltips.filter(function(t,e){return null!=r.values[e]}).map(function(t,e){var i=t||a._options.format(r.values[e]),n='\n\t\t\t\t<span style="display:inline-block;position:relative;top:-1px;margin-right:5px;width:6px;height:6px;border-radius:50%;background-color:'+(a._options.lineColors[e]||a._options.lineColor)+'"></span>\n\t\t\t';return 1<r.tooltips.length?n+i:i}).join("<br />")}},{key:"_onHoverAreaOver",value:function(i){var t=(this._tooltipGroup.attr("visibility"),0),e=this._xAxis,n=this._yAxis,r=this._options.width,a=e(i.label);this._tooltipGroup.transition().duration(t).attr("visibility","visible").attr("transform","translate("+a+", 0)");var o=this._tooltipBottomLabel.node().getBBox().width,s=this._getTextAnchor(a,o,r);this._tooltipBottomLabel.text(i.label).attr("text-anchor",s),this._tooltipBottomLabel.attr("transform",function(){return{start:"translate("+-a+", 0)",middle:"translate(0, 0)",end:"translate("+(r-a)+", 0)"}[s]});var l=50+o;this._tooltipBottomLabelMask.attr("width",l).attr("x",function(){return{start:-a-25,middle:-l/2,end:r-a-l+25}[s]}),this._handleMaskGradientEl.attr("x1",-l/2),this._handleMaskGradientEl.attr("x2",l/2);var h=this._getTooltipHTML(i);this._tooltipTopLabel.node().innerHTML=h;var u=this._getLabelLeft(a);i.values.some(function(t){return null!=t})?(this._tooltipTopLabel.style("left",u+"px").style("visibility","visible").style("top",n(Math.max.apply(Math,i.values))-50+"px"),this._tooltipLineCircle.transition().duration(t).style("visibility",function(t,e){return i.values[e]?"visible":"hidden"}).attr("cy",function(t,e){return i.values[e]?n(i.values[e]):0})):(this._tooltipTopLabel.style("visibility","hidden"),this._tooltipLineCircle.style("visibility","hidden"))}},{key:"_getLabelLeft",value:function(t){var e=this._tooltipTopLabel.node().offsetWidth,i=t-e/2;return i<0&&(i=0),i>this._options.width-e&&(i=this._options.width-e),i}},{key:"_onMouseOut",value:function(){this._groupEl.node().parentNode.contains(_.event.relatedTarget)||(this._hideTooltip(),this._tooltipLineCircle.style("visibility","hidden"))}},{key:"_hideTooltip",value:function(){this._tooltipGroup.attr("visibility","hidden"),this._tooltipTopLabel.style("visibility","hidden")}},{key:"_renderTooltip",value:function(){var e,i=this,t=this._lineData.getMergedData(),n=this._lineData.getSeries();e=t.length>n.length?this._options.width/(t.length-1):this._options.width,this._hoverAreas=this._groupEl.selectAll("."+tt["tooltip-hover-area"]).data(t).enter().append("rect").attr("class",tt["tooltip-hover-area"]).attr("width",e).attr("fill-opacity",0).attr("x",function(t){return i._xAxis(t.label)-e/2}).attr("height",this._options.height).on("mouseover",this._onHoverAreaOver.bind(this)),this._tooltipGroup=this._groupEl.append("g").attr("visibility","hidden").attr("class",tt["tooltip-group"]),this._tooltipLineCircle=this._tooltipGroup.selectAll("."+tt["tooltip-line-circle"]).data(n).enter().append("circle").attr("visibility","hidden").attr("class",tt["tooltip-line-circle"]).attr("stroke-width",this._options.lineWidth).attr("stroke",function(t,e){return i._options.lineColors[e]||i._options.lineColor}).attr("stroke-opacity",this._options.lineOpacity).attr("r",2.5+this._options.lineWidth/2),this._tooltipAxisCircle=this._tooltipGroup.append("circle").attr("class",tt["tooltip-axis-circle"]).attr("stroke-width",1).attr("cy",this._options.height-K).attr("r",3),this._tooltipBottomLabelMask=this._tooltipGroup.append("rect").attr("fill","url(#"+this._handleMaskGradientEl.attr("id")+")").attr("class",tt["tooltip-label-mask"]).attr("y",this._options.height-5-15).attr("height",20),this._tooltipBottomLabel=this._tooltipGroup.append("text").attr("class",tt["tooltip-label"]).attr("y",this._options.height-5).attr("text-anchor","start").text(t[0].label),this._tooltipTopLabel=_.select(this._groupEl.node().parentNode.parentNode).insert("span",":first-child").attr("class",tt["tooltip-top-label"]).style("position","absolute").style("visibility","hidden"),this._tooltipRendered=!0}},{key:"_createMaskGradientElement",value:function(){return this._handleMaskGradientEl=this._groupEl.append("linearGradient").attr("id",tt["tooltip-label-mask"]+"-"+et+++"-gradient").attr("gradientUnits","userSpaceOnUse").attr("y1","0").attr("x1","0").attr("y2","0").attr("x2","0"),this._handleMaskGradientEl.selectAll("stop").data([{offset:"0%",color:"rgba(255,255,255,0)"},{offset:"20%",color:"rgba(255,255,255,1)"},{offset:"80%",color:"rgba(255,255,255,1)"},{offset:"100%",color:"rgba(255,255,255,0)"}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),this._handleMaskGradientEl}},{key:"_clear",value:function(){this._tooltipRendered&&(this._hoverAreas.remove(),this._tooltipGroup.remove(),this._tooltipTopLabel.remove(),this._tooltipRendered=!1)}},{key:"update",value:function(t,e,i){return this._xAxis=e,this._yAxis=i,this._lineData=t,this._createMaskGradientElement(),this._clear(),this._renderTooltip(),this}},{key:"destroy",value:function(){return this._rendered&&this._clear(),this._observable.destroy(),this}}]),nt);function nt(t){P(this,nt),this._options=t,this._groupEl=null,this._lineData=null,this._xAxis=null,this._yAxis=null,this._rendered=!1,this._observable=new a(["pointOver"])}var rt=(i(at,[{key:"isRendered",value:function(){return this._rendered}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"render",value:function(t){var e=this._containerEl=_.select(t),i=this._options.width,n=this._options.height;return e.style("position","relative"),this._svgEl=e.append("svg").attr("width",i).attr("height",n).classed(tt.svg,!0).classed(tt.line,!0),this._groupEl=this._svgEl.append("g"),this._tooltipRenderer.render(this._groupEl),this._rendered=!0,this}},{key:"_clear",value:function(){this._groupEl.node().innerHTML=""}},{key:"update",value:function(t){var i=this;this._lineData=t,this._clear();var e=this._options.width,n=this._options.height,r=this._options.verticalSpacing,a=t.getSeries(),o=t.getAllData(),s=t.getMinMax(),l=this._xAxis=_.scalePoint().range([0,e]),h=this._yAxis=_.scaleLinear().range([n-r,r]);return l.domain(o.map(function(t){return t.label})),h.domain([s.min,s.max]),this._renderZeroLine(o),a.forEach(function(t,e){i._renderDataLines(t,e)}),this._renderXAxis(o),this._tooltipRenderer.update(t,l,h),this}},{key:"_renderXAxis",value:function(t){this._groupEl.append("line").attr("x1",0).attr("x2",this._options.width).attr("y1",this._options.height-K).attr("y2",this._options.height-K).attr("stroke-width",1).attr("stroke",this._options.axisColor),1<t.length?(this._groupEl.append("text").text(t[0].label).attr("x",0).attr("y",this._options.height-5),this._groupEl.append("text").text(t[t.length-1].label).attr("x",this._options.width).attr("text-anchor","end").attr("y",this._options.height-5)):1==t.length&&this._groupEl.append("text").text(t[0].label).attr("x",this._options.width/2).attr("text-anchor","middle").attr("y",this._options.height-5)}},{key:"_showZeroLine",value:function(){return this._yAxis(0)<this._options.height-K-10}},{key:"_renderZeroLine",value:function(){this._showZeroLine()&&this._groupEl.append("line").attr("x1",0).attr("x2",this._options.width).attr("y1",Math.round(this._yAxis(0))).attr("y2",Math.round(this._yAxis(0))).attr("stroke-dasharray","2 ,2").attr("stroke",this._options.zeroLineColor)}},{key:"_renderDataLines",value:function(t,e){var i=this,n=this._xAxis,r=this._yAxis,a=this._options,o=this._options.height-K,s=this._showZeroLine()?Math.min(o,r(0)):o,l=a.lineColors[e]||a.lineColor,h=a.fillColors[e]||a.fillColor,u=_.area().x(function(t){return n(t.label)}).y0(s).y1(function(t){return r(t.value)}),c=_.line().x(function(t){return n(t.label)}).y(function(t){return r(t.value)});this._getGroupedData(t).forEach(function(t){1<t.length&&i._groupEl.append("path").data([t]).attr("class",tt.area).attr("fill",h).attr("fill-opacity",a.fillOpacity).attr("d",u),t.length&&i._groupEl.append("path").data([t]).attr("fill","none").attr("stroke-linecap","round").attr("stroke",l).attr("stroke-opacity",1).attr("stroke-width",1<t.length?a.lineWidth:a.dotSize).attr("class",tt.line).attr("d",function(t){var e=c(t);return e&&2==e.split(",").length?e+" "+e:e})})}},{key:"_getGroupedData",value:function(t){var e=[],i=[e];return t.forEach(function(t){null===t.value?(e=[],i.push(e)):e.push(t)}),i}},{key:"destroy",value:function(){return this._rendered&&this._containerEl.node().removeChild(this._svgEl.node()),this._observable.destroy(),this}}]),at);function at(t){P(this,at),this._options=t,this._containerEl=null,this._groupEl=null,this._svgEl=null,this._lineData=null,this._xAxis=null,this._yAxis=null,this._rendered=!1,this._prevData=null,this._observable=new a(["pointOver"]),this._tooltipRenderer=new it(t)}function ot(t,e){return void 0===t?e:t}var st=(i(lt,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._lineRenderer.destroy(),this._options=null,this}},{key:"render",value:function(t){return this._lineRenderer.render(t),this}},{key:"setSeries",value:function(t){return this.setData.apply(this,t)}},{key:"setData",value:function(){if(!this._lineRenderer.isRendered())throw"Can't call setData() when widget is not rendered, please call .render() first.";for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=this._lineData=new Q(e,this._options);return this._options.format?"string"==typeof this._options.format&&(this._options.format=_.format(this._options.format)):this._options.format=_.format(",."+this._lineData.getPrecision()+"f"),this._lineRenderer.update(n),this}}]),lt);function lt(t){var e=this;P(this,lt),this._options={},this._options.width=ot(t.width,360),this._options.height=ot(t.height,200),this._options.lineWidth=ot(t.lineWidth,3),this._options.dotSize=ot(t.dotSize,6),this._options.format=ot(t.format,null),this._options.lineColor=ot(t.lineColor,"#7ed321"),this._options.lineColors=ot(t.lineColors,q),this._options.lineOpacity=ot(t.lineOpacity,1),this._options.fillColor=ot(t.fillColor,"#7ed321"),this._options.fillColors=ot(t.fillColors,Y),this._options.fillOpacity=ot(t.fillOpacity,.1),this._options.axisColor=ot(t.axisColor,"#f0f0f0"),this._options.zeroLineColor=ot(t.zeroLineColor,"#bababa"),this._options.verticalSpacing=ot(t.verticalSpacing,this._options.height/4),this._observable=new a(["pointOver"]),this._lineRenderer=new rt(this._options),this._lineRenderer.on("pointOver",function(t){e._observable.fire("pointOver",t)})}var ht="_circle",ut=["#49ace2","#ca62dc"],ct="#f0f0f0",_t="Only";t("\r\ng text {\r\n    user-select: none;\r\n}\r\n\r\n._barchart_18afp_11 {\r\n    background-color: white;\r\n}\r\n\r\n._barchart_18afp_11 text {\r\n    font-family: Roboto;\r\n}\r\n\r\n._barchart_18afp_11 ._clickable-area_18afp_27 {\r\n}\r\n\r\n\r\n._bar_18afp_11 {\r\n}\r\n\r\n._bar_18afp_11._bar-disabled_18afp_41 text {\r\n    fill: #cacaca;\r\n}\r\n._bar_18afp_11._bar-disabled_18afp_41 ._stripe_18afp_47 ._progress_18afp_47 {\r\n    fill: #c9c9c9;\r\n}\r\n\r\n._bar_18afp_11._hover-enabled_18afp_55:hover ._stripe_18afp_47 ._progress_18afp_47,\r\n._bar_18afp_11._bar-highlighted_18afp_57 ._stripe_18afp_47 ._progress_18afp_47 {\r\n    fill: #ffea00;\r\n}\r\n\r\n._bar_18afp_11._hover-enabled_18afp_55:hover ._details_18afp_65 ._onlyTool_18afp_65 {\r\n    visibility: visible;\r\n}\r\n\r\n\r\n\r\n._details_18afp_65 text {\r\n    font-family: Roboto, sans-serif;\r\n}\r\n\r\n._details_18afp_65._details-disabled_18afp_85 text {\r\n    fill: #cacaca;\r\n}\r\n\r\n._details_18afp_65 ._label_18afp_93 {\r\n    font-weight: 700;\r\n}\r\n\r\n._details_18afp_65 ._tooltip_18afp_101 ._symbol_18afp_101 {\r\n    font-weight: 900;\r\n}\r\n\r\n._details_18afp_65 ._onlyTool_18afp_65 {\r\n    visibility: hidden;\r\n}\r\n\r\n._details_18afp_65 text._onlyTool_18afp_65 {\r\n    font-weight: 400;\r\n    fill: #bababa;\r\n}\r\n\r\n._details_18afp_65 g._onlyTool_18afp_65:hover text {\r\n    fill: #0081ff;\r\n}\r\n\r\n._details_18afp_65 ._tooltip_18afp_101 ._tooltip-text_18afp_135 {\r\n}\r\n\r\n\r\n._stripe_18afp_47 {\r\n}\r\n\r\n._stripe_18afp_47 ._progress_18afp_47 {\r\n}\r\n\r\n._stripe_18afp_47 ._progress_18afp_47 {\r\n}\r\n\r\n\r\n._tip-wrapper_18afp_163 {\r\n    position: absolute;\r\n    margin: 0;\r\n    left: 0;\r\n    z-index: 10001 !important;\r\n}\r\n\r\n._tip-wrapper_18afp_163 ._tip_18afp_163 {\r\n    position: absolute;\r\n    right: 17px;\r\n    top: -9px;\r\n    max-width: 240px;\r\n\r\n    margin: 0;\r\n    padding: 8px 10px;\r\n\r\n    background-color: #4a4a4a;\r\n    color: rgba(255, 255, 255, 0.87);\r\n    border-radius: 5px;\r\n    font-weight: 500;\r\n    font-family: Roboto, sans-serif;\r\n    font-size: 11px;\r\n    line-height: 1.5;\r\n    text-align: center;\r\n    white-space: normal;\r\n\r\n    transform: scale(0);\r\n    transform-origin: right center;\r\n\r\n    transition: transform 150ms cubic-bezier(0.25, 0.8, 0.25, 1);\r\n    transition-delay: .5s;\r\n}",{});var dt={barchart:"_barchart_18afp_11","clickable-area":"_clickable-area_18afp_27",bar:"_bar_18afp_11","bar-disabled":"_bar-disabled_18afp_41",stripe:"_stripe_18afp_47",progress:"_progress_18afp_47","hover-enabled":"_hover-enabled_18afp_55","bar-highlighted":"_bar-highlighted_18afp_57",details:"_details_18afp_65",onlyTool:"_onlyTool_18afp_65","details-disabled":"_details-disabled_18afp_85",label:"_label_18afp_93",tooltip:"_tooltip_18afp_101",symbol:"_symbol_18afp_101","tooltip-text":"_tooltip-text_18afp_135","tip-wrapper":"_tip-wrapper_18afp_163",tip:"_tip_18afp_163"},ft=(i(pt,[{key:"getBar",value:function(t){return this._barsData[t]}},{key:"setBar",value:function(t,e){this._barsData[t]=e}},{key:"calculateMinMax",value:function(t){var r=0<arguments.length&&void 0!==t?t:"sum";if("sum"!==r)return"auto"===r?{min:this.bars.reduce(function(t,e){return Math.min(t,e.calculateMinMax(r).min)},0),max:this.bars.reduce(function(t,e){return Math.max(t,e.calculateMinMax(r).max)},0)}:r;var a=!1,o=!1,e=this.bars.reduce(function(t,e){var i=e.calculateMinMax(r).min,n=e.calculateMinMax(r).max;return i<0&&(a=!0),0<n&&(o=!0),t+Math.max(Math.abs(i),Math.abs(n))},0);return{min:a?-e:0,max:o?e:0}}},{key:"getPrecision",value:function(t){var i=0<arguments.length&&void 0!==t?t:"max";return"max"===i?this.bars.reduce(function(t,e){return Math.max(t,e.getPrecision(i))},0):i}},{key:"details",get:function(){return this._detailsData},set:function(t){this._detailsData=t}},{key:"bars",get:function(){return this._barsData}}],[{key:"copyAs",value:function(t){return new pt({},t.details,t.bars)}}]),pt);function pt(t,e,i){if(P(this,pt),void 0===i)throw"barsData is required parameter";this._detailsData=e,this._barsData=i}var vt=(i(gt,[{key:"getTooltip",value:function(t){return this._tooltips[t]}},{key:"addTooltip",value:function(t){void 0===this._tooltips&&(this._tooltips=[]),this._tooltips.push(t)}},{key:"setTooltip",value:function(t,e){this._tooltips[t]=e}},{key:"getPrecision",value:function(t){var e=0<arguments.length&&void 0!==t?t:"max";return"max"===e?this.tooltips?this.tooltips.reduce(function(t,e){return Math.max(t,e.getPrecision())},0):0:e}},{key:"label",get:function(){return this._label},set:function(t){this._label=t}},{key:"tooltips",get:function(){return this._tooltips}},{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=t}}],[{key:"copyAs",value:function(t){return new gt({label:t.label,disabled:t.disabled},t.tooltips)}}]),gt);function gt(t,e){var i=t.label,n=t.disabled;if(P(this,gt),void 0===i)throw"label is required parameter";this._label=i,this._disabled=n,this._tooltips=e}var bt=(i(yt,[{key:"getPrecision",value:function(t){var e=0<arguments.length&&void 0!==t?t:"max";if("max"!==e)return e;if(this.isNumber()){var i=this.text.toString();return i.includes(".")?i.split(".")[1].length:0}return 0}},{key:"isNumber",value:function(){return!isNaN(parseFloat(this.text))&&isFinite(this.text)}},{key:"symbol",get:function(){return this._symbol},set:function(t){this._symbol=t}},{key:"color",get:function(){return this._color},set:function(t){this._color=t}},{key:"text",get:function(){return this._text},set:function(t){this._text=t}}],[{key:"copyAs",value:function(t){return new yt({text:t.text,symbol:t.symbol,color:t.color})}}]),yt);function yt(t){var e=t.text,i=t.symbol,n=t.color;if(P(this,yt),void 0===e)throw"text is required parameter";this._symbol=i,this._color=n,this._text=e}var mt=(i(kt,[{key:"getStripe",value:function(t){return this._stripesData[t]}},{key:"setStripe",value:function(t,e){this._stripesData[t]=e}},{key:"calculateMinMax",value:function(t){var r=0<arguments.length&&void 0!==t?t:"sum";if("sum"!==r)return"auto"===r?{min:this.stripes.reduce(function(t,e){return Math.min(t,e.calculateMinMax(r).min)},0),max:this.stripes.reduce(function(t,e){return Math.max(t,e.calculateMinMax(r).max)},0)}:r;var a=!1,o=!1,e=this.stripes.reduce(function(t,e){var i=e.calculateMinMax(r).min,n=e.calculateMinMax(r).max;return i<0&&(a=!0),0<n&&(o=!0),t+Math.max(Math.abs(i),Math.abs(n))},0);return{min:a?-e:0,max:o?e:0}}},{key:"getPrecision",value:function(t){var e=0<arguments.length&&void 0!==t?t:"max";return void 0===this.details?0:null===this.details?0:this.details.getPrecision(e)}},{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=t}},{key:"highlighted",get:function(){return this._highlighted},set:function(t){this._highlighted=t}},{key:"details",get:function(){return this._detailsData},set:function(t){this._detailsData=t}},{key:"stripes",get:function(){return this._stripesData}}],[{key:"copyAs",value:function(t){return new kt({disabled:t.disabled,highlighted:t.highlighted},t.details,t.stripes)}}]),kt);function kt(t,e,i){var n=t.disabled,r=t.highlighted;if(P(this,kt),void 0===i)throw"stripesData is required parameter";this._disabled=n,this._highlighted=r,this._detailsData=e,this._stripesData=i}var xt=(i(wt,[{key:"calculateMinMax",value:function(t){var e=0<arguments.length&&void 0!==t?t:"sum";return this.dual?"sum"===e?{min:Math.min(0,this.left.value,this.right.value),max:Math.max(0,this.left.value+this.right.value)}:"auto"===e?{min:Math.min(0,this.left.value,this.right.value),max:Math.max(0,this.left.value,this.right.value)}:e:"sum"===e||"auto"===e?{min:Math.min(0,this.value),max:Math.max(0,this.value)}:e}},{key:"dual",get:function(){return void 0===this._value}},{key:"value",get:function(){return this._value},set:function(t){this._value=t}},{key:"color",get:function(){return this._color},set:function(t){this._color=t}},{key:"left",get:function(){return this._left},set:function(t){this._left=t}},{key:"right",get:function(){return this._right},set:function(t){this._right=t}}],[{key:"copyAs",value:function(t){return t.dual?new wt({right:t.right,left:t.left}):new wt({value:t.value,color:t.color})}}]),wt);function wt(t){var e=t.value,i=t.color,n=t.right,r=(n=void 0===n?{}:n).value,a=n.color,o=t.left,s=(o=void 0===o?{}:o).value,l=o.color;if(P(this,wt),void 0===e){if(void 0===r)throw"value or leftValue is required parameter";if(void 0===s)throw"value or rightValue is required parameter";this._right={value:r,color:a},this._left={value:s,color:l}}else this._value=e,this._color=i}var St=(i(Dt,[{key:"convert",value:function(t){var e=void 0;if(void 0!==t.details){var i=void 0;void 0!==t.details.tooltips&&(i=t.details.tooltips.map(function(t){return new bt(t)})),e=new vt(t.details,i)}var n=t.bars.map(function(t){var e=void 0;if(void 0!==t.details){var i=void 0;void 0!==t.details.tooltips&&(i=t.details.tooltips.map(function(t){return new bt(t)})),e=new vt(t.details,i)}var n=t.stripes.map(function(t){return new xt(t)});return new mt(t,e,n)});return new ft(t,e,n)}}]),Dt);function Dt(){P(this,Dt)}var Tt=0,Et=(i(Ct,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"_renderContainer",value:function(t,e,i){var n=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==i?i:0;return _.select(t).append("g").attr("class",dt[this.className]).attr("transform","translate("+n+", "+r+")")}},{key:"render",value:function(t,e,i,n){var r=1<arguments.length&&void 0!==e?e:0,a=this,o=2<arguments.length&&void 0!==i?i:0,s=3<arguments.length&&void 0!==n?n:0;if(this.destroy(),this._container=this._renderContainer(t,r,o),this._container.datum(s),this._container.on("click",function(t){a._observable.fire("click",t)}).on("mouseenter",function(t){a._observable.fire("enter",t)}).on("mouseleave",function(t){a._observable.fire("leave",t)}),!this._container)throw"Component "+this._className+" was not rendered. Check your selector: "+t;var l=this._container.append("rect").attr("class",dt["clickable-area"]).attr("fill","transparent").attr("width",this.width).attr("height",this.height);return this.alignBottom&&l.attr("y",-this.height),this.alignRight&&l.attr("x",-this.width),this._render(s),this}},{key:"_render",value:function(t){}},{key:"destroy",value:function(){return this.isRendered()&&(this.clearData(),this._container.datum(null),this._container.remove(),this._container=null),this}},{key:"isRendered",value:function(){return null!==this._container}},{key:"setData",value:function(t){if(!this.isRendered())throw"Can't call setData() when component is not rendered, please call .render() first.";return"Object"===t.constructor.name&&(t=(new St).convert(t)),this.clearData(),this._data=t,this._setData(t),this}},{key:"clearData",value:function(){if(!this.isRendered())throw"Can't call clearData() when widget is not rendered, please call .render() first.";return this._clearData(),this._data=null,this}},{key:"_setData",value:function(t){}},{key:"_clearData",value:function(){}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this.isRendered()&&this._container.select("."+dt["clickable-area"]).attr("width",t),this.alignRight&&this._container.select("."+dt["clickable-area"]).attr("x",-t)}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this.isRendered()&&this._container.select("."+dt["clickable-area"]).attr("height",t),this.alignBottom&&this._container.select("."+dt["clickable-area"]).attr("y",-t)}},{key:"className",get:function(){return this._className}},{key:"container",get:function(){return this._container}},{key:"alignRight",get:function(){return this._alignRight}},{key:"alignBottom",get:function(){return this._alignBottom}},{key:"data",get:function(){return this._data}}]),Ct);function Ct(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"component",n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=4<arguments.length&&void 0!==arguments[4]&&arguments[4];P(this,Ct),this._width=t,this._height=e,this._container=null,this._maskIndex=Tt++,this._className=i,this._observable=new a(["enter","leave","click"]),this._alignRight=n,this._alignBottom=r,this._data=null}function Mt(t,e){var i=e.node().getContext("2d"),n=window.getComputedStyle(t.node()),r=n.getPropertyValue("font-style"),a=n.getPropertyValue("font-variant"),o=n.getPropertyValue("font-weight"),s=n.getPropertyValue("font-strech"),l=n.getPropertyValue("font-size"),h=n.getPropertyValue("font-family");return i.font=r+" "+a+" "+o+" "+s+" "+l+" "+h,i.measureText(t.text()).width}var Lt=(r(Ot,Et),i(Ot,[{key:"_render",value:function(){this.container.append("text").text("-").attr("class",dt["tooltip-text"]).attr("text-anchor","end").attr("font-size",this.fontSize),_.select(".text-width-helper").empty()?this._canvas=_.select("body").append("canvas").attr("class","text-width-helper").style("display","none").text("Helper element for computing text width"):this._canvas=_.select(".text-width-helper")}},{key:"_setData",value:function(t){var e=this.format;if(!this.format.includes(".")){var i=_.formatSpecifier(this.format);i.precision=t.getPrecision("max"),e=i.toString()}var n=t.text;t.isNumber()&&(n=_.format(e)(t.text));var r=Mt(this.container.select("."+dt["tooltip-text"]).text(n),this._canvas);if(t.symbol||this.symbol){var a=void 0;a=t.color instanceof Array?(this._renderTwoColoredFill(t.color[0],t.color[1]),"url(#two-colored-symbol-"+this._maskIndex+")"):this.activeColor instanceof Array?(this._renderTwoColoredFill(this.activeColor[0],this.activeColor[1]),"url(#two-colored-symbol-"+this._maskIndex+")"):t.color?t.color:this.activeColor,"_circle"===(t.symbol?t.symbol:this.symbol)?(this.container.append("circle").attr("r",3).attr("fill",a).attr("cx",-r-this.space).attr("cy",-this.fontSize/3),r+=6+this.space):r+=Mt(this.container.append("text").text(t.symbol?t.symbol:this.symbol).attr("class",dt.symbol).attr("text-anchor","end").attr("font-size",this.fontSize).attr("fill",a).attr("x",-r-this.space),this._canvas)+this.space}this.width=r}},{key:"_renderTwoColoredFill",value:function(t,e){var i=this.container.append("pattern").attr("id","two-colored-symbol-"+this._maskIndex).attr("width","1").attr("height","1").attr("patternContentUnits","objectBoundingBox");i.append("rect").attr("fill",t).attr("width","1").attr("height","1"),i.append("path").attr("fill",e).attr("d","M0,0 L1,0 L1,1 Z")}},{key:"_clearData",value:function(){this.container.select("."+dt["tooltip-text"]).text("-"),this.container.select("."+dt.symbol).remove()}},{key:"fontSize",get:function(){return this._fontSize}},{key:"symbol",get:function(){return this._symbol}},{key:"activeColor",get:function(){return this._activeColor}},{key:"format",get:function(){return this._format}},{key:"space",get:function(){return this._space}}]),Ot);function Ot(t){var e=t.fontSize,i=void 0===e?11:e,n=t.width,r=void 0===n?i:n,a=t.height,o=void 0===a?i:a,s=t.symbol,l=t.activeColor,h=void 0===l?ut[0]:l,u=t.format,c=void 0===u?",f":u,_=t.space,d=void 0===_?7:_;P(this,Ot);var f=B(this,(Ot.__proto__||Object.getPrototypeOf(Ot)).call(this,r,o,"tooltip",!0,!0));return f._fontSize=i,f._symbol=s,f._activeColor=h,f._format=c,f._space=d,f._canvas,f}var At=(r(Rt,Et),i(Rt,[{key:"_render",value:function(){this._onlyToolTextSvg=this.container.append("text").text(this.onlyToolText).attr("class",dt.onlyTool).attr("x","-7").attr("text-anchor","end").attr("font-size",this.fontSize),_.select(".text-width-helper").empty()?this._canvas=_.select("body").append("canvas").attr("class","text-width-helper").style("display","none").text("Helper element for computing text width"):this._canvas=_.select(".text-width-helper"),this.width=Mt(this._onlyToolTextSvg,this._canvas)+14}},{key:"onlyToolText",get:function(){return this._onlyToolText}},{key:"fontSize",get:function(){return this._fontSize}}]),Rt);function Rt(t){var e=t.fontSize,i=void 0===e?11:e,n=t.onlyToolText,r=void 0===n?_t:n,a=t.width,o=void 0===a?i:a,s=t.height,l=void 0===s?i:s;P(this,Rt);var h=B(this,(Rt.__proto__||Object.getPrototypeOf(Rt)).call(this,o,l,"onlyTool",!0,!0));return h._fontSize=i,h._onlyToolText=r,h._canvas,h}var Ht=(r(zt,Et),i(zt,[{key:"_render",value:function(){this._label=this.container.append("text").text("").attr("class",dt.label).attr("x",10).attr("y",this.labelFontSize).attr("font-size",this.labelFontSize);var t=this.container.append("linearGradient").attr("id","tooltips-background");t.append("stop").attr("offset","0%").attr("stop-color","white").attr("stop-opacity","0"),t.append("stop").attr("offset","100%").attr("stop-color","white").attr("stop-opacity","1"),_.select(".text-width-helper").empty()?this._canvas=_.select("body").append("canvas").attr("class","text-width-helper").style("display","none").text("Helper element for computing text width"):this._canvas=_.select(".text-width-helper"),_.select("."+dt.tip).empty()?(this._tipWrapper=_.select("body").append("span").attr("class",dt["tip-wrapper"]),this._tip=this._tipWrapper.append("span").attr("class",dt.tip)):(this._tipWrapper=_.select("."+dt["tip-wrapper"]),this._tip=_.select("."+dt.tip))}},{key:"_setData",value:function(t){this._clearData(),this._label.text(t.label),this.container.classed(dt["details-disabled"],t.disabled),t.tooltips&&(this._createTooltips(t),this._renderAndSetTooltipsData(t.tooltips)),this.showOnlyTool&&this.enableToggle&&(this._createOnlyTool(),this._renderOnlyTool()),Mt(this._label,this._canvas)>this._rightSideStart&&this._handleLongLabel(this._rightSideStart)}},{key:"_createOnlyTool",value:function(){this._onlyTool=new At({fontSize:this.tooltipFontSize-1,onlyToolText:this.onlyToolText})}},{key:"_renderOnlyTool",value:function(){var e=this,t=this.container.datum();this._onlyTool.render(this.container.node(),this._rightSideStart,this.labelFontSize-1,t).on("click",function(t){_.event.stopPropagation(),e._observable.fire("selectOnly",t)}),this._rightSideStart-=this._onlyTool.width+24}},{key:"_createTooltips",value:function(t){var i=this,n=t.tooltips;n.slice().reverse();var r=this.format;if(!this.format.includes(".")){var e=_.formatSpecifier(this.format);e.precision=t.getPrecision("max"),r=e.toString()}this._tooltips=n.map(function(t,e){return new Lt({fontSize:i.tooltipFontSize,symbol:1<n.length?i.tooltipSymbol:void 0,activeColor:i.activeColors[e%i.activeColors.length],format:r})})}},{key:"_renderAndSetTooltipsData",value:function(a){var o=this,s=this.width-10;this._tooltips.forEach(function(t,e){var i=o._tooltips.length-1-e,n=o._tooltips[i],r=a[i];n.render(o.container.node(),s,o.labelFontSize,i),n.setData(r),s-=n.width+24}),this._rightSideStart=s+12}},{key:"_handleLongLabel",value:function(t){var e=this;this._tooltipsBackground=this.container.insert("g","g."+dt.tooltip),this._tooltipsBackground.append("rect").attr("x",t- -10).attr("y",0).attr("width",this.width-t-10).attr("height",this.height).attr("fill","white"),this._tooltipsBackground.append("rect").attr("x",t- -10-40).attr("y",0).attr("width",41).attr("height",this.height).attr("fill","url(#tooltips-background)"),this._label.on("mouseenter",function(){var t=document.documentElement.getBoundingClientRect().width-e._getOffset(e._label.node()).left;e._tipWrapper.style("right",t+"px").style("top",e._getOffset(e._label.node()).top+"px"),e._tip.text(e._label.text()).style("transition-delay",".5s").style("transform","scale(1)")}),this._label.on("mouseleave",function(){e._tip.style("transition-delay","0s").style("transform","scale(0)")})}},{key:"_getOffset",value:function(t){var e=t.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY}}},{key:"_clearData",value:function(){this.container.select("."+dt.label).text("-"),this.container.selectAll("."+dt.tooltip).remove()}},{key:"labelFontSize",get:function(){return this._labelFontSize}},{key:"tooltipFontSize",get:function(){return this._tooltipFontSize}},{key:"tooltipSymbol",get:function(){return this._tooltipSymbol}},{key:"activeColors",get:function(){return this._activeColors},set:function(t){this._activeColors=t}},{key:"format",get:function(){return this._format},set:function(t){this._format=t}},{key:"tooltips",get:function(){return this._tooltips}},{key:"showOnlyTool",get:function(){return this._showOnlyTool}},{key:"onlyToolText",get:function(){return this._onlyToolText}},{key:"enableToggle",get:function(){return this._enableToggle}}]),zt);function zt(t){var e=t.width,i=void 0===e?360:e,n=t.height,r=void 0===n?o+10:n,a=t.labelFontSize,o=void 0===a?13:a,s=t.tooltipFontSize,l=void 0===s?11:s,h=t.tooltipSymbol,u=void 0===h?ht:h,c=t.activeColors,_=void 0===c?ut:c,d=t.format,f=void 0===d?",f":d,p=t.showOnlyTool,v=void 0===p||p,g=t.onlyToolText,b=void 0===g?_t:g,y=t.enableToggle,m=void 0!==y&&y;P(this,zt);var k=B(this,(zt.__proto__||Object.getPrototypeOf(zt)).call(this,i,r,"details"));return k._labelFontSize=o,k._tooltipFontSize=l,k._tooltipSymbol=u,k._activeColors=_,k._format=f,k._showOnlyTool=v,k._onlyToolText=b,k._enableToggle=m,k._tooltips,k._tooltipsBackground,k._label,k._tipWrapper,k._tip,k._canvas,k._observable.add("selectOnly"),k}var Pt=0,Bt=(r(Ft,Et),i(Ft,[{key:"_render",value:function(){var t=this.container.append("clipPath").attr("id","rounded-corners-"+this._maskIndex);this.topCornerRounded&&this.bottomCornerRounded?t.append("rect").attr("width",this.width).attr("height",this.height).attr("rx",Math.min(this.width,this.height)/2).attr("ry",Math.min(this.width,this.height)/2):this.topCornerRounded||this.bottomCornerRounded?(t.append("rect").attr("width",this.width-2*this.height).attr("height",this.height).attr("x",this.height),this.topCornerRounded&&(t.append("circle").attr("cx",this.height).attr("cy",this.height).attr("r",this.height),t.append("circle").attr("cx",this.width-this.height).attr("cy",this.height).attr("r",this.height)),this.bottomCornerRounded&&(t.append("circle").attr("cx",this.height).attr("cy",0).attr("r",this.height),t.append("circle").attr("cx",this.width-this.height).attr("cy",0).attr("r",this.height))):t.append("rect").attr("width",this.width).attr("height",this.height),this._renderProgress(0,this.width,this.backgroundColor,"stripe-background")}},{key:"_setData",value:function(t){this.dualValue?(this._renderStripe(0,this.width/2-.5,t.left.value,t.left.color?t.left.color:this.activeColors[1]?this.activeColors[1]:this.activeColors[0],!0),this._renderStripe(this.width/2+.5,this.width,t.right.value,t.right.color?t.right.color:this.activeColors[0],!1)):this._renderStripe(0,this.width,t.value,t.color?t.color:this.activeColors[0])}},{key:"_clearData",value:function(){this.container.selectAll(dt.progress).remove()}},{key:"_renderXBase",value:function(t){this.container.append("line").attr("x1",t).attr("x2",t).attr("y1",0).attr("y2",this.condensed?-4:-7).attr("stroke","#C9C9C9").attr("stroke-width",1).attr("stroke-dasharray",[1,2]),this.container.append("line").attr("x1",t).attr("x2",t).attr("y1",this.height).attr("y2",this.height+(this.condensed?4:7)).attr("stroke","#C9C9C9").attr("stroke-width",1).attr("stroke-dasharray",[1,2])}},{key:"_renderStripe",value:function(t,e,i,n,r){var a=4<arguments.length&&void 0!==r&&r,o=_.scaleLinear().range([t,e]);a?o.domain([this.minMax.max,this.minMax.min]):o.domain([this.minMax.min,this.minMax.max]);var s=o(0);this.minMax.min<0&&0<this.minMax.max&&this._renderXBase(s),a===i<0?this._renderProgress(s,o(i),n):this._renderProgress(o(i),s,n)}},{key:"_renderProgress",value:function(t,e,i,n){var r=3<arguments.length&&void 0!==n?n:"progress";i instanceof Array&&this._renderTwoColoredFill(i[0],i[1]),this.container.append("rect").attr("fill",i instanceof Array?"url(#two-colored-"+this._maskIndex+"-"+Pt+")":i).attr("class",dt[r]).attr("x",t).attr("y",0).attr("width",e-t).attr("height",this.height).attr("transform","translate(0, 0)").attr("clip-path","url(#rounded-corners-"+this._maskIndex+")")}},{key:"_renderTwoColoredFill",value:function(t,e){Pt++;var i=this.container.append("pattern").attr("id","two-colored-"+this._maskIndex+"-"+Pt).attr("width","20").attr("height","20").attr("patternUnits","userSpaceOnUse");i.append("rect").attr("fill",t).attr("width","20").attr("height","20"),i.append("path").attr("fill",e).attr("d","M20,0 L10,0 L20,10 Z"),i.append("path").attr("fill",e).attr("d","M0,0 L20,20 L10,20 L0,10 Z")}},{key:"dualValue",get:function(){return this._dualValue}},{key:"backgroundColor",get:function(){return this._backgroundColor}},{key:"activeColors",get:function(){return this._activeColors}},{key:"minMax",get:function(){return this._minMax}},{key:"topCornerRounded",get:function(){return this._topCornerRounded}},{key:"bottomCornerRounded",get:function(){return this._bottomCornerRounded}},{key:"condensed",get:function(){return this._condensed}}]),Ft);function Ft(t){var e=t.width,i=void 0===e?360:e,n=t.height,r=void 0===n?5:n,a=t.backgroundColor,o=void 0===a?ct:a,s=t.activeColors,l=void 0===s?ut:s,h=t.dualValue,u=void 0!==h&&h,c=t.minMax,_=void 0===c?"sum":c,d=t.topCornerRounded,f=void 0===d||d,p=t.bottomCornerRounded,v=void 0===p||p,g=t.condensed,b=void 0!==g&&g;P(this,Ft);var y=B(this,(Ft.__proto__||Object.getPrototypeOf(Ft)).call(this,i,r,"stripe"));return y._backgroundColor=o,y._activeColors=l,y._dualValue=u,y._minMax=_,y._topCornerRounded=f,y._bottomCornerRounded=v,y._condensed=b,y}var Vt=(r(jt,Et),i(jt,[{key:"_render",value:function(){this.detailsHidden||(this._createDetails(),this._renderDetails()),this.container.classed(dt["hover-enabled"],this.enableHover),this.enableToggle&&this._doEnableToggle()}},{key:"_setData",value:function(t){this._disabled=t.disabled,this.container.classed(dt["bar-disabled"],this.disabled),this.container.classed(dt["bar-highlighted"],t.highlighted),this._setDetailsData(t.details),this._createStripes(t),this._renderStripes(),this._setStripesData(t)}},{key:"_clearData",value:function(){this.detailsHidden||this._details.clearData()}},{key:"_setDisabledValue",value:function(t){this._disabled=t.disabled,this.container.classed(dt["bar-disabled"],this.disabled)}},{key:"_createDetails",value:function(){this._details=new Ht({width:this.width,height:this.detailsHeight,labelFontSize:this.labelFontSize,tooltipFontSize:this.tooltipFontSize,tooltipSymbol:this.tooltipSymbol,activeColors:this.activeColors,format:this.format,showOnlyTool:this.showOnlyTool,onlyToolText:this.onlyToolText,enableToggle:this.enableToggle})}},{key:"_renderDetails",value:function(){var e=this,t=this.container.datum();this._details.render(this.container.node(),0,0,t).on("selectOnly",function(t){e._observable.fire("selectOnly",t)})}},{key:"_setDetailsData",value:function(t){if(this.details){var e=vt.copyAs(t);this.details.setData(e)}}},{key:"_createStripes",value:function(n){var r=this,a=n.calculateMinMax(this.minMax);this._stripes=n.stripes.map(function(t,e){var i=void 0;return i=1<n.stripes.length?[r.activeColors[e%r.activeColors.length]]:r.activeColors.slice(),new Bt({width:r.width,activeColors:i,dualValue:r.dualValue,minMax:a,backgroundColor:r.stripeBackgroundColor,topCornerRounded:0===e,bottomCornerRounded:e===n.stripes.length-1,condensed:r.detailsHidden})})}},{key:"_renderStripes",value:function(){var i=this,n=this.detailsHidden?0:this.detailsHeight;this.stripes.forEach(function(t,e){t.render(i.container.node(),0,n+5*e,e)})}},{key:"_setStripesData",value:function(t){var i=this;t.stripes.forEach(function(t,e){return i.stripes[e].setData(t)})}},{key:"_doEnableToggle",value:function(){var e=this;this.container.attr("cursor","pointer"),this.on("click",function(t){e._disabled=!e._disabled,e.container.classed(dt["bar-disabled"],e.disabled),e._observable.fire("disabled",t,e._disabled)})}},{key:"labelFontSize",get:function(){return this._labelFontSize}},{key:"tooltipFontSize",get:function(){return this._tooltipFontSize}},{key:"tooltipSymbol",get:function(){return this._tooltipSymbol}},{key:"activeColors",get:function(){return this._activeColors}},{key:"minMax",get:function(){return this._minMax}},{key:"detailsHidden",get:function(){return this._detailsHidden}},{key:"detailsHeight",get:function(){return this._detailsHeight}},{key:"enableToggle",get:function(){return this._enableToggle}},{key:"enableHover",get:function(){return this._enableHover}},{key:"dualValue",get:function(){return this._dualValue}},{key:"disabled",get:function(){return this._disabled}},{key:"format",get:function(){return this._format}},{key:"stripeBackgroundColor",get:function(){return this._stripeBackgroundColor}},{key:"stripes",get:function(){return this._stripes}},{key:"details",get:function(){return this._details}},{key:"showOnlyTool",get:function(){return this._showOnlyTool}},{key:"onlyToolText",get:function(){return this._onlyToolText}}]),jt);function jt(t){var e=t.width,i=void 0===e?360:e,n=t.height,r=void 0===n?43:n,a=t.labelFontSize,o=void 0===a?13:a,s=t.tooltipFontSize,l=void 0===s?11:s,h=t.tooltipSymbol,u=void 0===h?ht:h,c=t.activeColors,_=void 0===c?ut:c,d=t.minMax,f=void 0===d?"sum":d,p=t.detailsHidden,v=void 0!==p&&p,g=t.detailsHeight,b=void 0===g?o+10:g,y=t.enableHover,m=void 0!==y&&y,k=t.enableToggle,x=void 0!==k&&k,w=t.dualValue,S=void 0!==w&&w,D=t.disabled,T=void 0!==D&&D,E=t.format,C=void 0===E?",f":E,M=t.stripeBackgroundColor,L=void 0===M?ct:M,O=t.showOnlyTool,A=void 0===O||O,R=t.onlyToolText,H=void 0===R?_t:R;P(this,jt);var z=B(this,(jt.__proto__||Object.getPrototypeOf(jt)).call(this,i,r,"bar"));return z._labelFontSize=o,z._tooltipFontSize=l,z._tooltipSymbol=u,z._activeColors=_,z._minMax=f,z._detailsHidden=v,z._detailsHeight=b,z._enableHover=m,z._enableToggle=x,z._dualValue=S,z._disabled=T,z._format=C,z._stripeBackgroundColor=L,z._showOnlyTool=A,z._onlyToolText=H,z._details,z._stripes,z._observable.add("disabled").add("selectOnly"),z}var It=(r(Nt,Et),i(Nt,[{key:"isBarDisabled",value:function(t){return this.bars[t].disabled}},{key:"updateData",value:function(t){this.setData(t(this.data))}},{key:"updateDetailsData",value:function(t){this.setDetailsData(t(this.details.data))}},{key:"updateBarData",value:function(t,e){this.setBarData(t,e(this.bars[t].data))}},{key:"setDetailsData",value:function(t){var e=vt.copyAs(t);this.details.setData(e)}},{key:"setBarData",value:function(t,e){var i=mt.copyAs(e);this._setDefaultBarDetails(e),this.bars[t].setData(i)}},{key:"_setDefaultBarDetails",value:function(n){var r=this;n.details||(n.details=new vt({label:this.data.details.label})),void 0===n.details.tooltips&&n.stripes.forEach(function(t,e){var i=void 0;i=1<n.stripes.length?[r.activeColors[e%r.activeColors.length]]:r.activeColors.slice(),r.dualValue?(n.details.addTooltip(new bt({text:t.left.value,symbol:r.tooltipSymbol,color:t.left.color?t.left.color:i[1]?i[1]:i[0]})),n.details.addTooltip(new bt({text:t.right.value,symbol:r.tooltipSymbol,color:t.right.color?t.right.color:i[0]}))):n.details.addTooltip(new bt({text:t.value,symbol:1<n.stripes.length?r.tooltipSymbol:void 0,color:t.color?t.color:i[0]}))})}},{key:"_renderContainer",value:function(t,e,i){var n=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==i?i:0;return this._svgWrapper=_.select(t).append("svg").attr("class",dt[this.className]).attr("width",this.width).attr("height",this.height),this._svgWrapper.style({position:"relative",left:n,top:r}),this._svgWrapper.append("g")}},{key:"_render",value:function(){this.detailsVisible&&(this._createDetails(),this._renderDetails()),this._doSelectOnly()}},{key:"_doSelectOnly",value:function(){var t=this;this.on("selectOnly",function(n){t.bars.forEach(function(t,e){var i=t.data;i.disabled=n!==e,t._setDisabledValue(i)})})}},{key:"_setData",value:function(t){var i=this;t.bars.forEach(function(t){return i._setDefaultBarDetails(t)}),this.detailsVisible&&(this._adjustDetails(t),this.setDetailsData(t.details)),this._adjustHeight(t),this._createBars(t),this._renderBars(),t.bars.forEach(function(t,e){return i.setBarData(e,t)})}},{key:"_clearData",value:function(){this.detailsVisible&&this._details.clearData(),this._container.selectAll("."+dt.bar).remove()}},{key:"_adjustDetails",value:function(t){if(!this.details.format.includes(".")){var e=_.formatSpecifier(this.format);e.precision=t.getPrecision("max"),this.details.format=e.toString()}this.dualValue&&t.details.tooltips&&1===t.bars[0].stripes.length&&(this.details.activeColors=this.details.activeColors.slice().reverse())}},{key:"_createDetails",value:function(){this._details=new Ht({width:this.width,height:this.detailsHeight,labelFontSize:this.labelFontSize,tooltipFontSize:this.tooltipFontSize,tooltipSymbol:this.tooltipSymbol,activeColors:this.activeColors,format:this.format,showOnlyTool:!1})}},{key:"_renderDetails",value:function(){this._details.render(this._container.node(),0,0)}},{key:"_createBars",value:function(t){var e=this,i=this.format;if(!this.format.includes(".")){var n=_.formatSpecifier(this.format);n.precision=t.getPrecision("max"),i=n.toString()}var r=t.calculateMinMax(this.minMax);this._bars=t.bars.map(function(){return new Vt({width:e.width,height:e.barHeight,labelFontSize:e.labelFontSize,tooltipFontSize:e.tooltipFontSize,tooltipSymbol:e.tooltipSymbol,activeColors:e.activeColors,detailsHidden:e.detailsVisible,detailsHeight:e.detailsHeight,dualValue:e.dualValue,enableToggle:e.enableBarToggle,enableHover:e.enableBarHover,minMax:r,format:i,stripeBackgroundColor:e.stripeBackgroundColor,showOnlyTool:e.showOnlyTool,onlyToolText:e.onlyToolText})})}},{key:"_renderBars",value:function(){var n=this,r=this._container.append("g").on("mouseenter",function(){n._observable.fire("barsEnter")}).on("mouseleave",function(){n.detailsVisible&&n.enableBarHover&&n.details.setData(n.data.details),n._observable.fire("barsLeave")});this.bars.forEach(function(t,e){var i=n.detailsVisible?n.detailsHeight:0;t.render(r.node(),0,i+n.barHeight*e,e).on("click",function(t){n._observable.fire("barClick",t)}).on("enter",function(t){n.detailsVisible&&n.enableBarHover&&n.details.setData(n.bars[t].data.details),n._observable.fire("barEnter",t)}).on("leave",function(t){n._observable.fire("barLeave",t)}).on("disabled",function(t,e){if(n.detailsVisible&&n.enableBarHover){var i=n.details.data;i.disabled=e,n.details.setData(i)}n._observable.fire("barDisabled",t,e)}).on("selectOnly",function(t){n._observable.fire("selectOnly",t)})})}},{key:"_adjustHeight",value:function(t){var e=t.bars.length*this.barHeight;this.detailsVisible&&(e+=this.detailsHeight),this.height=e,this._svgWrapper.attr("height",e)}},{key:"labelFontSize",get:function(){return this._labelFontSize}},{key:"tooltipFontSize",get:function(){return this._tooltipFontSize}},{key:"tooltipSymbol",get:function(){return this._tooltipSymbol}},{key:"activeColors",get:function(){return this._activeColors}},{key:"minMax",get:function(){return this._minMax}},{key:"detailsVisible",get:function(){return this._detailsVisible}},{key:"detailsHeight",get:function(){return this._detailsHeight}},{key:"dualValue",get:function(){return this._dualValue}},{key:"barHeight",get:function(){return this._barHeight}},{key:"enableBarHover",get:function(){return this._enableBarHover}},{key:"enableBarToggle",get:function(){return this._enableBarToggle}},{key:"format",get:function(){return this._format}},{key:"stripeBackgroundColor",get:function(){return this._stripeBackgroundColor}},{key:"details",get:function(){return this._details}},{key:"bars",get:function(){return this._bars}},{key:"showOnlyTool",get:function(){return this._showOnlyTool}},{key:"onlyToolText",get:function(){return this._onlyToolText}}]),Nt);function Nt(t){var e=t.width,i=void 0===e?360:e,n=t.height,r=void 0===n?129:n,a=t.labelFontSize,o=void 0===a?13:a,s=t.tooltipFontSize,l=void 0===s?11:s,h=t.tooltipSymbol,u=void 0===h?ht:h,c=t.activeColors,_=void 0===c?ut:c,d=t.minMax,f=void 0===d?"sum":d,p=t.detailsVisible,v=void 0!==p&&p,g=t.detailsHeight,b=void 0===g?o+10:g,y=t.dualValue,m=void 0!==y&&y,k=t.barHeight,x=void 0===k?43:k,w=t.enableBarHover,S=void 0!==w&&w,D=t.enableBarToggle,T=void 0!==D&&D,E=t.format,C=void 0===E?",f":E,M=t.stripeBackgroundColor,L=void 0===M?ct:M,O=t.showOnlyTool,A=void 0===O||O,R=t.onlyToolText,H=void 0===R?_t:R;P(this,Nt);var z=B(this,(Nt.__proto__||Object.getPrototypeOf(Nt)).call(this,i,r,"barchart"));return z._labelFontSize=o,z._tooltipFontSize=l,z._tooltipSymbol=u,z._activeColors=_,z._minMax=f,z._detailsVisible=v,z._detailsHeight=b,z._dualValue=m,z._barHeight=x,z._enableBarHover=S,z._enableBarToggle=T,z._format=C,z._stripeBackgroundColor=L,z._showOnlyTool=A,z._onlyToolText=H,z._details,z._bars,z._observable.add("barEnter").add("barLeave").add("barClick").add("barDisabled").add("barsEnter").add("barsLeave").add("selectOnly"),z}t("._linechart_12tzg_1 text {\r\n    font-size: 11px;\r\n    fill:#7d7d7d;\r\n    font-family: Roboto;\r\n}\r\n\r\n._white-fill_12tzg_13 {\r\n    fill:#ffffff;\r\n}\r\n\r\n._linechart_12tzg_1 text._white-fill_12tzg_13 {\r\n    fill:#ffffff;\r\n}\r\n\r\n._linechart_12tzg_1 {\r\n    overflow: visible;\r\n}\r\n\r\n._area_12tzg_37 {\r\n    \r\n}\r\n\r\n._linechart-mask_12tzg_45 {\r\n\r\n}\r\n\r\n._tooltip-group_12tzg_53 {\r\n    \r\n}\r\n\r\n._tooltip-hover-area_12tzg_61 {\r\n    \r\n}\r\n\r\n._tooltip-line-circle_12tzg_69 {\r\n    fill: white;\r\n}\r\n\r\n._label-axis-circle_12tzg_77 {\r\n    stroke:#bababa;\r\n    fill: white;\r\n}\r\n\r\n._tooltip-label-mask_12tzg_87 {\r\n}\r\n\r\n._tooltip-top-label_12tzg_93 {\r\n    border-radius: 4px;\r\n    font-size: 11px;\r\n    pointer-events: none;\r\n    white-space: nowrap;\r\n    font-family: Roboto;    \r\n    padding:3px 10px;\r\n    line-height:17px;\r\n    z-index:10;\r\n\r\n    color: #4a4a4a;\r\n    background-color: #ffffff;\r\n    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n._tooltip-top-label_12tzg_93._dark_12tzg_123 {\r\n    color: #ffffff;\r\n    background-color: #4a4a4a;\r\n    box-shadow: none;\r\n    text-align: center;\r\n}\r\n\r\n._tooltip-top-label_12tzg_93._dark_12tzg_123 hr {\r\n    display: block;\r\n    height: 1px;\r\n    border: 0;\r\n    border-top: 1px solid #666666;\r\n    margin: 4px 8px;\r\n    padding: 0;\r\n}",{});var Gt={linechart:"_linechart_12tzg_1","white-fill":"_white-fill_12tzg_13",area:"_area_12tzg_37","linechart-mask":"_linechart-mask_12tzg_45","tooltip-group":"_tooltip-group_12tzg_53","tooltip-hover-area":"_tooltip-hover-area_12tzg_61","tooltip-line-circle":"_tooltip-line-circle_12tzg_69","label-axis-circle":"_label-axis-circle_12tzg_77","tooltip-label-mask":"_tooltip-label-mask_12tzg_87","tooltip-top-label":"_tooltip-top-label_12tzg_93",dark:"_dark_12tzg_123"},Wt=(i(Xt,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"_renderContainer",value:function(t,e,i){var n=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==i?i:0;return _.select(t).append("g").attr("class",Gt[this.className]).attr("transform","translate("+n+", "+r+")")}},{key:"render",value:function(t,e,i,n){var r=1<arguments.length&&void 0!==e?e:0,a=this,o=2<arguments.length&&void 0!==i?i:0,s=3<arguments.length&&void 0!==n?n:0;if(this.destroy(),this._container=this._renderContainer(t,r,o),!this._container)throw"Component "+this._className+" was not rendered. Check your selector: "+t;return this._container.datum(s),this._container.on("click",function(t){a._observable.fire("click",t)}).on("mouseenter",function(t){a._observable.fire("enter",t)}).on("mouseleave",function(t){a._observable.fire("leave",t)}),this}},{key:"destroy",value:function(){return this.isRendered()&&(this._lastData=null,this._clearData(),this._container.datum(null),this._container.remove(),this._container=null),this}},{key:"isRendered",value:function(){return null!==this._container}},{key:"setData",value:function(t){if(!this.isRendered())throw"Can't call setData() when component is not rendered, please call .render() first.";return this._setData(this._container,t,this._lastData),this._lastData=Object.assign({},this._lastData,t),this}},{key:"_setData",value:function(t,e,i){}},{key:"_clearData",value:function(t){}},{key:"className",get:function(){return this._className}},{key:"container",get:function(){return this._container}},{key:"observable",get:function(){return this._observable}}]),Xt);function Xt(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"component";P(this,Xt),this._container=null,this._className=t,this._observable=new a(["enter","leave","click"]),this._lastData=null}var Zt="#0081ff",Ut="#f8e71c",Jt=(r(qt,Wt),i(qt,[{key:"_setData",value:function(t,e,i){if(1===Object.keys(e).length&&e.appearance)return this._updateAppearance(e.appearance);if(1===Object.keys(e).length&&(e.point||null===e.point)){var n=Object.assign({},i,e);return this._updatePoint(n)}this.container.selectAll("*").remove();var r=Object.assign({},i,e);this._parts=this._renderLine(r),this._point=this._renderPoint(),this._updateAppearance(r.appearance),this._updatePoint(r)}},{key:"_renderPoint",value:function(){return this.container.append("circle").attr("visibility","hidden").attr("class",Gt["tooltip-line-circle"])}},{key:"_updatePoint",value:function(t){var e=this,i=t.point,n=t.appearance,r=t.lineData,a=t.xAxis,o=t.yAxis;i?r.forEach(function(t){i&&null!==t.value&&String(i)===String(t.id)&&e._point.attr("visibility","visible").attr("stroke-width",n.lineWidth||3).attr("stroke",n.lineColor||Zt).attr("stroke-opacity",n.lineOpacity||1).attr("r",2.5+(n.lineWidth||3)/2).attr("transform","translate("+a(i)+", "+o(t.value)+")")}):this._point.attr("visibility","hidden")}},{key:"_updateAppearance",value:function(t){var i=t.lineColor,n=t.lineOpacity,r=t.fillColor,a=t.fillOpacity,o=t.lineWidth,s=t.dotSize;this._parts.forEach(function(t){var e=1<t.path.data()[0].length?o||3:s||6;t.path.attr("stroke",i||Zt).attr("stroke-opacity",isNaN(n)?1:n).attr("stroke-width",e),t.area&&t.area.attr("fill",r||"#0081ff").attr("fill-opacity",isNaN(a)?.1:a)})}},{key:"_renderLine",value:function(t){var i=this,e=t.height,n=t.xAxis,r=t.yAxis,a=t.lineData,o=t.renderAreas,s=e-28,l=Math.max(Math.min(s,r(0)),0),h=_.area().x(function(t){return n(t.id)}).y0(l).y1(function(t){return r(t.value)}),u=_.line().x(function(t){return n(t.id)}).y(function(t){return r(t.value)});return this._getPartedData(a).map(function(t){var e={};return o&&1<t.length&&(e.area=i.container.append("path").data([t]).attr("class",Gt.area).attr("d",h)),t.length&&(e.path=i.container.append("path").data([t]).attr("fill","none").attr("stroke-linecap","round").attr("class",Gt.line).attr("d",function(t){var e=u(t);return e&&2==e.split(",").length?e+" "+e:e})),e})}},{key:"_getPartedData",value:function(t){var e=void 0,i=!0,n=[];return t.forEach(function(t){i=null===t.value||(i&&(e=[],n.push(e)),e.push(t),!1)}),n}},{key:"_shouldRenderZeroLine",value:function(t,e){return t(0)<e-28-10}}]),qt);function qt(){return P(this,qt),B(this,(qt.__proto__||Object.getPrototypeOf(qt)).call(this,"linechart-line"))}var Yt=(r(Kt,Wt),i(Kt,[{key:"_setData",value:function(t,e,i){var n=this.height/4,r=_.scalePoint().range([0,this.width]),a=_.scaleLinear().range([this.height-n,13]);r.domain(e.series[0].data.map(function(t){return t.id}));var o=this._calculateMinMax(e.series);a.domain([o.min,o.max]);var s=this._mergeSeriesData(e.series);this._renderTooltipAreas(t,r,a,s),this._renderTooltipLines(t,r,a,e.series),this._renderAnnotations(t,r,e.annotations,s)}},{key:"_renderAnnotations",value:function(n,r,t,a){var o=this,s=this._mergeAnnotations(t);Object.keys(s).forEach(function(t,e){if(void 0!==r(t)){var i=n.append("g").on("mouseenter",function(){return o.observable.fire("annotationEnter",s[t],a[t],t,e)}).on("mouseleave",function(){return o.observable.fire("annotationLeave",s[t],a[t],t,e)});i.append("line").attr("x1",r(t)).attr("x2",r(t)).attr("y1",0).attr("y2",o.height-28).attr("stroke-width",3).attr("stroke","transparent"),1<s[t].length&&i.append("circle").attr("fill","transparent").attr("cx",r(t)).attr("cy",o.height-28).attr("r",7.5)}else console.warn("Annotation (in mask component) "+JSON.stringify(s[t])+" has id '"+t+"' which is not present in linechart data")})}},{key:"_mergeAnnotations",value:function(t){var e={};return t.forEach(function(t){e[t.id]=e[t.id]||[],e[t.id].push(t)}),e}},{key:"_renderTooltipAreas",value:function(i,n,t,r){var a=this,o=this.width;1<Object.keys(r).length&&(o=this.width/(Object.keys(r).length-1)),Object.keys(r).forEach(function(t,e){i.append("rect").attr("class",Gt["tooltip-hover-area"]).attr("width",o).attr("fill-opacity",0).attr("x",function(){return n(t)-o/2}).attr("height",a.height).on("mouseover",function(){return a.observable.fire("tooltipEnter",r[t],t,e)}).on("mouseleave",function(){return a.observable.fire("tooltipLeave",r[t],t,e)})})}},{key:"_mergeSeriesData",value:function(t){var i={};return t.forEach(function(e){e.data.forEach(function(t){i[t.id]=i[t.id]||[],i[t.id].push({id:t.id,label:t.label,value:t.value,tooltip:t.tooltip,appearance:e.appearance})})}),i}},{key:"_renderTooltipLines",value:function(i,n,r,a){var o=this;Array.from(a).reverse().forEach(function(t,e){t.title&&o._renderTooltipLine(i,n,r,t,a.length-1-e)})}},{key:"_renderTooltipLine",value:function(t,e,i,n,r){var a=this,o=Object.assign({},n.appearance,{lineOpacity:0,lineWidth:2*(n.appearance.lineWidth||3),dotSize:2*(n.appearance.dotSize||6)}),s=new Jt;s.render(t.node()),s.setData({height:this.height,xAxis:e,yAxis:i,lineData:n.data,appearance:o,renderAreas:!1}),s.on("enter",function(){return a.observable.fire("lineEnter",n,r)}).on("leave",function(){return a.observable.fire("lineLeave",n,r)})}},{key:"_calculateMinMax",value:function(t){var e=[];t.forEach(function(t){t.data.forEach(function(t){e.push(t)})});var i=_.min(e,function(t){return t.value}),n=_.max(e,function(t){return t.value});return e.length<=t.length&&(i=Math.min(i,0),n=Math.max(n,0)),{min:i,max:n}}},{key:"_getGroupedData",value:function(t){var e=[],i=[e];return t.forEach(function(t){null===t.value?(e=[],i.push(e)):e.push(t)}),i}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),Kt);function Kt(t,e){P(this,Kt);var i=B(this,(Kt.__proto__||Object.getPrototypeOf(Kt)).call(this,"linechart-mask"));return i._width=t,i._height=e,i.observable.add("lineEnter"),i.observable.add("lineLeave"),i.observable.add("tooltipEnter"),i.observable.add("tooltipLeave"),i.observable.add("annotationEnter"),i.observable.add("annotationLeave"),i}var Qt=0,$t=(r(te,Wt),i(te,[{key:"_setData",value:function(t,e,i){if(1===Object.keys(e).length&&void 0!==e.visible)return this.container.attr("visibility",e.visible?"visible":"hidden");this.container.selectAll("*").remove();var n=Object.assign({},i,e);this._renderLabel(n),n.renderDot&&this._renderCircle(n),this.container.attr("visibility",e.visible?"visible":"hidden")}},{key:"_renderCircle",value:function(t){this.container.append("circle").attr("class",Gt["label-axis-circle"]).attr("stroke-width",1).attr("cx",t.x).attr("cy",t.y).attr("r",3)}},{key:"_renderLabel",value:function(t){var e=this.container.append("rect").attr("class",Gt["tooltip-label-mask"]).attr("y",t.y+23-15).attr("height",20),i=this.container.append("text").attr("class",Gt["tooltip-label"]).attr("y",t.y+23).text(t.label),n=i.node().getComputedTextLength(),r=this._getTextAnchor(t.x,n,t.width),a=50+n;this._createMaskGradientElement(this.container,a),e.attr("width",a).attr("fill","url(#"+this.container.select("linearGradient").attr("id")+")").attr("x",-a/2).attr("transform",function(){return{start:"translate("+n/2+", 0)",middle:"translate("+t.x+", 0)",end:"translate("+(t.width-n/2)+", 0)"}[r]}),i.attr("text-anchor",r).attr("transform",function(){return{start:"translate(0, 0)",middle:"translate("+t.x+", 0)",end:"translate("+t.width+", 0)"}[r]})}},{key:"_createMaskGradientElement",value:function(t,e){t.append("linearGradient").attr("id",Gt["tooltip-label-mask"]+"-"+Qt+++"-gradient").attr("gradientUnits","userSpaceOnUse").attr("y1","0").attr("x1",-e/2).attr("y2","0").attr("x2",e/2).selectAll("stop").data([{offset:"0%",color:"rgba(255,255,255,0)"},{offset:"20%",color:"rgba(255,255,255,1)"},{offset:"80%",color:"rgba(255,255,255,1)"},{offset:"100%",color:"rgba(255,255,255,0)"}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color})}},{key:"_getTextAnchor",value:function(t,e,i){return t-e/2<0?"start":i<t+e/2?"end":"middle"}}]),te);function te(){return P(this,te),B(this,(te.__proto__||Object.getPrototypeOf(te)).call(this,"linechart-label"))}var ee=(r(ie,Wt),i(ie,[{key:"_renderContainer",value:function(t){return _.select(t).style("position","relative"),_.select(t).insert("span",":first-child").attr("class",Gt["tooltip-top-label"]).style("position","absolute").style("visibility","hidden")}},{key:"_setData",value:function(t,e,i){var n=Object.assign({},i,e);this._renderTooltip(n)}},{key:"_renderTooltip",value:function(t){this.container.node().innerHTML=t.html,this.container.style("left",this._getLabelLeft(t.x,t.width)+"px").style("top",this._getLabelTop(t.y)+"px").style("visibility",t.visible?"visible":"hidden").classed(Gt.dark,t.dark)}},{key:"_getLabelLeft",value:function(t,e){var i=this.container.node().offsetWidth,n=t-i/2;return n<0&&(n=0),e-i<n&&(n=e-i),n}},{key:"_getLabelTop",value:function(t){var e=t-12-this.container.node().offsetHeight;return 0<=e?e:t+12}}]),ie);function ie(){return P(this,ie),B(this,(ie.__proto__||Object.getPrototypeOf(ie)).call(this,"linechart-tooltip"))}var ne=(r(re,Wt),i(re,[{key:"_setData",value:function(t,e,i){return 1===Object.keys(e).length&&void 0!==e.highlight||(this.container.selectAll("*").remove(),this._annotation=this._renderAnnotation(e)),this._updateAppearance(e.highlight)}},{key:"_updateAppearance",value:function(t){this._annotation.line.attr("stroke",t?Ut:"#8f959c"),this._annotation.circle&&this._annotation.circle.attr("fill",t?Ut:"#8f959c"),this._annotation.text&&this._annotation.text.classed(Gt["white-fill"],!t)}},{key:"_renderAnnotation",value:function(t){var e=t.xAxis,i=t.id,n=t.height,r=t.length,a={};return a.line=this.container.append("line").attr("x1",e(i)).attr("x2",e(i)).attr("y1",0).attr("y2",n-28).attr("stroke-width",1).attr("stroke-dasharray","2 ,2"),1<r&&(a.circle=this.container.append("circle").attr("cx",e(i)).attr("cy",n-28).attr("r",7.5),a.text=this.container.append("text").attr("x",e(i)).attr("y",n-28+4).attr("text-anchor","middle").text(r)),a}}]),re);function re(){return P(this,re),B(this,(re.__proto__||Object.getPrototypeOf(re)).call(this,"linechart-annotation"))}function ae(t){var e=t.width,i=void 0===e?360:e,n=t.height,r=void 0===n?200:n;P(this,ae);var a=B(this,(ae.__proto__||Object.getPrototypeOf(ae)).call(this,"linechart"));return a._width=i,a._height=r,a}return{Barchart:It,Doughnut:v,Histogram:U,Line:st,Linechart:(r(ae,Wt),i(ae,[{key:"_renderContainer",value:function(t,e,i){var n=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==i?i:0;return this._renderTooltip(t),_.select(t).append("svg").attr("width",this.width).attr("height",this.height).attr("class",Gt[this.className]).attr("transform","translate("+n+", "+r+")")}},{key:"_setData",value:function(t,e,i){t.selectAll("*").remove();var n=this._getAxes(e.series),r=n.xAxis,a=n.yAxis;this._renderZeroLine(t,r,a),this._renderXAxis(t,"#f0f0f0",e.series),this._renderLabel(t),this._renderAnnotations(t,r,e.annotations),this._renderDataLines(t,r,a,e.series),this._renderMask(t,e,r,a)}},{key:"_getAxes",value:function(t){var e=this.height/4,i=_.scalePoint().range([0,this.width]),n=_.scaleLinear().range([this.height-e,13]);i.domain(t[0].data.map(function(t){return t.id}));var r=this._calculateMinMax(t);return n.domain([r.min,r.max]),{xAxis:i,yAxis:n}}},{key:"_clearData",value:function(){this._width=null,this._height=null,this._tooltip.destroy(),this._tooltip=null,this._label=null,this._lines=null}},{key:"_renderTooltip",value:function(t){this._tooltip=new ee,this._tooltip.render(t),this._tooltip.setData({html:"",x:0,y:0,dark:!1,visible:!1,width:this.width})}},{key:"_renderZeroLine",value:function(t,e,i){this._shouldRenderZeroLine(i)&&t.append("line").attr("x1",0).attr("x2",this.width).attr("y1",Math.round(i(0))).attr("y2",Math.round(i(0))).attr("stroke-dasharray","2 ,2").attr("stroke","#bababa")}},{key:"_renderXAxis",value:function(t,e,i){t.append("line").attr("x1",0).attr("x2",this.width).attr("y1",this.height-28).attr("y2",this.height-28).attr("stroke-width",1).attr("stroke",e),1<i[0].data.length?(t.append("text").text(i[0].data[0].label).attr("x",0).attr("y",this.height-28+23),t.append("text").text(i[0].data[i[0].data.length-1].label).attr("x",this.width).attr("text-anchor","end").attr("y",this.height-28+23)):1==i[0].data.length&&t.append("text").text(i[0].data[0].label).attr("x",this.width/2).attr("text-anchor","middle").attr("y",this.height-28+23)}},{key:"_renderLabel",value:function(t){this._label=new $t,this._label.render(t.node()),this._label.setData({x:0,y:this.height-28,width:360,label:"",visible:!1,renderDot:!0})}},{key:"_renderAnnotations",value:function(t,i,e){var n=this,r=this._mergeAnnotations(e);this._annotations=Object.keys(r).map(function(t){if(void 0!==i(t)){var e=new ne;return e.render(n.container.node()),e.setData({xAxis:i,id:t,height:n.height,length:r[t].length,highlight:!1}),e}console.warn("Annotation (in presentation component) "+JSON.stringify(r[t])+" has id '"+t+"' which is not present in linechart data")})}},{key:"_renderDataLines",value:function(t,i,n,e){var r=this;this._lines=Array.from(e).reverse().map(function(t){var e=new Jt;return e.render(r.container.node()),e.setData({height:r.height,xAxis:i,yAxis:n,lineData:t.data,appearance:t.appearance,renderAreas:!0,point:null}),e}),this._lines.reverse()}},{key:"_renderMask",value:function(r,t,a,i){var o=this,e=new Yt(this.width,this.height);e.render(r.node()),e.on("lineEnter",function(t,e){o._onLineEnter(r,t,e)}).on("lineLeave",function(t,e){o._onLineLeave(r,t,e)}).on("tooltipEnter",function(t,e){o._onValueEnter(a,i,t,e)}).on("tooltipLeave",function(t,e){o._onValueLeave(a,i,t,e)}).on("annotationEnter",function(t,e,i,n){o._onAnnotationEnter(r,a,t,e,i,n)}).on("annotationLeave",function(t,e,i,n){o._onAnnotationLeave(r,a,t,e,i,n)}).on("leave",function(){o._onLeave()}),e.setData(t)}},{key:"_onAnnotationEnter",value:function(t,e,i,n,r,a){this._annotations[a].setData({highlight:!0}),this._label.setData({x:e(r),label:n[0].label,visible:!0,renderDot:i.length<=1});var o=_.mouse(t.node());this._tooltip.setData({html:this._getAnnotationHTML(i),x:o[0],y:o[1],dark:!0,visible:!0})}},{key:"_onAnnotationLeave",value:function(t,e,i,n,r,a){this._annotations[a].setData({highlight:!1})}},{key:"_onValueEnter",value:function(t,e,i,n){this._lines.forEach(function(t){return t.setData({point:n})}),this._label.setData({x:t(n),label:i[0].label,visible:!0,renderDot:!0});var r=!1;i.forEach(function(t){return t.tooltip&&(r=!0)}),r?this._tooltip.setData({html:this._getValueTooltipHTML(i),x:t(n),y:e(Math.max.apply(Math,i.map(function(t){return t.value}))),dark:!1,visible:!0}):this._tooltip.setData({visible:!1})}},{key:"_onValueLeave",value:function(){this._lines.forEach(function(t){return t.setData({point:null})})}},{key:"_onLineEnter",value:function(t,e,i){var n=_.mouse(t.node());this._tooltip.setData({html:e.title,x:n[0],y:n[1],dark:!0,visible:!0});var r=Object.assign({},e.appearance,{lineColor:Ut,fillColor:Ut});this._lines[i].setData({appearance:r}),this._label.setData({visible:!1})}},{key:"_onLineLeave",value:function(t,e,i){this._lines[i].setData({appearance:e.appearance})}},{key:"_onLeave",value:function(){this._label.setData({visible:!1}),this._tooltip.setData({visible:!1})}},{key:"_getValueTooltipHTML",value:function(i){return i.filter(function(t){return null!=t.value}).map(function(t){var e=t.tooltip||t.value;return 1<i.length?'\n\t\t\t\t    <span style="display:inline-block;position:relative;top:-1px;margin-right:5px;width:6px;height:6px;border-radius:50%;background-color:'+(t.appearance.lineColor||Zt)+'"></span>\n\t\t\t    '+e:e}).join("<br />")}},{key:"_getAnnotationHTML",value:function(t){return t.map(function(t){return'<span style="font-weight: bold">'+t.title+"</span><br/><span>"+t.subtitle+"</span>"}).join("<hr />")}},{key:"_mergeAnnotations",value:function(t){var e={};return t.forEach(function(t){e[t.id]=e[t.id]||[],e[t.id].push(t)}),e}},{key:"_shouldRenderZeroLine",value:function(t){var e=t(0);return e<this.height-28-10&&0<e}},{key:"_calculateMinMax",value:function(t){var e=[];t.forEach(function(t){t.data.forEach(function(t){e.push(t)})});var i=_.min(e,function(t){return t.value}),n=_.max(e,function(t){return t.value});return e.length<=t.length&&(i=Math.min(i,0),n=Math.max(n,0)),{min:i,max:n}}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),ae)}});
//# sourceMappingURL=clever-charts-1.2.11.min.js.map
